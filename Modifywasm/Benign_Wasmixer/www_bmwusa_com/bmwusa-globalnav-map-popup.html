<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>bmwusa-globalnav-map-popup.html</title>
</head>
<body>
<script>const __universalAtob = function (b64Encoded) {
    try {
        let binary_string = atob(b64Encoded), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(b64Encoded, 'base64'));
    }
};
const __callWasmBuffer = 'AGFzbQEAAAABBAFgAAACDwEDanBtB2RkYnBia3gAAAMCAQAEBQFwAAIHBQMBAAEHEQIGbWVtb3J5AgAEY2puZwABCQgBAEEBCwIBAAoJAQcAQQIRAAAL';
const __callWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__callWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__callWasmBuffer, 'base64'));
    }
})());
const __wasmStringModules = ['AGFzbQEAAAAFg4CAgAABAAEGpYKAgAAxfwBBAQt/AEESC38AQcYAC38AQfAAC38AQY4BC38AQZgBC38AQaABC38AQbgBC38AQcQBC38AQdABC38AQfoBC38AQYICC38AQZQCC38AQZgCC38AQaACC38AQagCC38AQc4CC38AQfACC38AQZQDC38AQaIDC38AQbYDC38AQdIDC38AQeIDC38AQYgEC38AQZAEC38AQaQEC38AQbwEC38AQc4EC38AQeQEC38AQZwFC38AQbAFC38AQcwFC38AQegFC38AQfAFC38AQY4GC38AQZYGC38AQbQGC38AQbwGC38AQeAGC38AQf4GC38AQaIHC38AQaoHC38AQawHC38AQcoHC38AQdIHC38AQfoHC38AQYQIC38AQYwIC38AQZQICwe5g4CAADIGbWVtb3J5AgAFZGF0YTADAAVkYXRhMQMBBWRhdGEyAwIFZGF0YTMDAwVkYXRhNAMEBWRhdGE1AwUFZGF0YTYDBgVkYXRhNwMHBWRhdGE4AwgFZGF0YTkDCQZkYXRhMTADCgZkYXRhMTEDCwZkYXRhMTIDDAZkYXRhMTMDDQZkYXRhMTQDDgZkYXRhMTUDDwZkYXRhMTYDEAZkYXRhMTcDEQZkYXRhMTgDEgZkYXRhMTkDEwZkYXRhMjADFAZkYXRhMjEDFQZkYXRhMjIDFgZkYXRhMjMDFwZkYXRhMjQDGAZkYXRhMjUDGQZkYXRhMjYDGgZkYXRhMjcDGwZkYXRhMjgDHAZkYXRhMjkDHQZkYXRhMzADHgZkYXRhMzEDHwZkYXRhMzIDIAZkYXRhMzMDIQZkYXRhMzQDIgZkYXRhMzUDIwZkYXRhMzYDJAZkYXRhMzcDJQZkYXRhMzgDJgZkYXRhMzkDJwZkYXRhNDADKAZkYXRhNDEDKQZkYXRhNDIDKgZkYXRhNDMDKwZkYXRhNDQDLAZkYXRhNDUDLQZkYXRhNDYDLgZkYXRhNDcDLwZkYXRhNDgDMAv1iYCAADEAQQELEC5nb29nbGUtbWFwJTIwYQAAQRILMi5kZWFsZXItbWFwLWxvY2F0aW9uLXNlYXJjaF9faW5wdXQtaG9sZGVyJTIwaW5wdXQAAEHGAAsoLmRlYWxlci1tYXAtbG9jYXRpb24tc2VhcmNoX19zZWFyY2gtYnRuAABB8AALHS5nbG9iYWxuYXYtbWFwLXBvcHVwLS1hY3RpdmUAAEGOAQsIZGVza3RvcAAAQZgBCwdtb2JpbGUAAEGgAQsWc3RhbmRhbG9uZS1kZWFsZXItbWFwAABBuAELCy5nbG9iYWxuYXYAAEHEAQsLLmdsb2JhbG5hdgAAQdABCyhBSXphU3lDYWhzbWM5dWVNVS1rbjFZcDRFN3NhMGI3Q0xqSWk2WGcAAEH6AQsGY2xpY2sAAEGCAgsRZGVhbGVybWFwLnJlbmRlcgAAQZQCCwJ1AABBmAILBmtleXVwAABBoAILB21vYmlsZQAAQagCCyRnbG9iYWxuYXYtcHJpbWFyeV9fbWFwLS1raWxsLXNjcm9sbAAAQc4CCyAuZGVhbGVyLW1hcF9fdG9wLW5hdi1uZXctc2VhcmNoAABB8AILIi5maWx0ZXJhYmxlLWxpc3Qtdmlld19fbWFwLXRvZ2dsZQAAQZQDCwxkZWFsZXIub3BlbgAAQaIDCxJtZWFzdXJlLmR0bS50cmFjawAAQbYDCxpkdG1EZWFsZXJMb2NhdG9yTW9kYWxPcGVuAABB0gMLD25hdi50b2dnbGVGaWxsAABB4gMLJGdsb2JhbG5hdi1wcmltYXJ5X19tYXAtLWtpbGwtc2Nyb2xsAABBiAQLBmtleXVwAABBkAQLEmRlYWxlci5saXN0LXJlc2V0AABBpAQLF2ZpbHRlci5yZXNldC1saXN0LXZpZXcAAEG8BAsQbWFwLmNsb3NlLW1vZGFsAABBzgQLFWZpbHRlci50b2dnbGVEaXNwbGF5AABB5AQLNi5nbG9iYWxuYXYtcHJpbWFyeS1sb2NhdGlvbi1iYXJfX2ZsZXgtaG9sZGVyJTIwYnV0dG9uAABBnAULEm1lYXN1cmUuZHRtLnRyYWNrAABBsAULG2R0bURlYWxlckxvY2F0b3JNb2RhbENsb3NlAABBzAULGi5kZWFsZXItbWFwX19vdXR0ZXItc2hlbGwAAEHoBQsHc2VhcmNoAABB8AULHC5kZWFsZXItbWFwLWxvY2F0aW9uLXNlYXJjaAAAQY4GCwdyZXN1bHQAAEGWBgscLmRlYWxlci1tYXAtbG9jYXRpb24tc2VhcmNoAABBtAYLB2RldGFpbAAAQbwGCyMuZmlsdGVyYWJsZS1saXN0LXZpZXdfX2RlYWxlci1saXN0AABB4AYLHC5kZWFsZXItbWFwLWxvY2F0aW9uLXNlYXJjaAAAQf4GCyMuZmlsdGVyYWJsZS1saXN0LXZpZXdfX2RlYWxlci1saXN0AABBogcLB3Jlc3VsdAAAQaoHCwEAAEGsBwscLmRlYWxlci1tYXAtbG9jYXRpb24tc2VhcmNoAABBygcLB2RldGFpbAAAQdIHCyYuZmlsdGVyYWJsZS1saXN0LXZpZXdfX2RlYWxlci1kZXRhaWxzAABB+gcLCGRlc2t0b3AAAEGECAsHbW9iaWxlAABBjAgLB21vYmlsZQAAQZQICwhkZXNrdG9wAA=='].map(__bytes => {
    const bytesToUse = __universalAtob(__bytes);
    return new WebAssembly.Instance(new WebAssembly.Module(bytesToUse));
});
const lS = (wI, pos, iWC) => {
    let __str = '';
    if (!Array.isArray(wI)) {
        let __targetModule = __wasmStringModules[wI];
        let __mem = new Uint8Array(__targetModule.exports.memory.buffer);
        const __stringKey = `data${ pos }`;
        let __start = __targetModule.exports[__stringKey] - 1;
        let __str = '';
        let i = __start;
        let __c = __mem[i++];
        while (!(parseInt(__c) & 128) && __mem[i]) {
            __str += __c;
            __c = String.fromCharCode(__mem[i++]);
        }
        __str += __c;
        __str = decodeURIComponent(__str.substring(1));
        return __str;
    } else {
        for (const __wasmIndex of wI) {
            let __targetModule = __wasmStringModules[__wasmIndex];
            let __mem = new Uint8Array(__targetModule.exports.memory.buffer);
            const __stringKey = `data${ pos }`;
            let __start = __targetModule.exports[__stringKey] - 1;
            let i = __start;
            let __c = __mem[i++];
            while (!(parseInt(__c) & 128) && __mem[i]) {
                __str += __c;
                __c = String.fromCharCode(__mem[i++]);
            }
            __str += __c;
        }
        __str = decodeURIComponent(__str.substring(1));
        return __str;
    }
};
import { C as o } from '/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/component.js';
import { A as t } from '/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/ada-utils.js';
import {
    $ as s,
    h as l
} from '/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-measurement-data.js';
import '/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/index.js';
import '/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/index.esm.js';
import '/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/is-author.js';
import '/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/baseDomain.js';
import '/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/getbyourl.js';
import '/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/scroll-to.js';
import '/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/uid.js';
import '/etc.clientlibs/bmwusa/clientlibs/clientlib-site/bmwusa-clientlibs/bmwusa-chunks/resources/zipcode.js';
new o({
    el: '.globalnav-map-popup',
    name: 'globalnav-map-popup Component',
    baseStr: 'globalnav-map-popup',
    subscriptions: {
        'dealermap.popover-open': 'openMap',
        'dealermap.dealer-selected': 'storeDealer',
        'map.set-trap-focus': 'setTrapFocus',
        'map.remove-trap-focus': 'removeTrapFocus',
        'fill.clicked': 'closeMap',
        'map.close-map': 'closeMap',
        'window.resizeEnd': 'resizeEvt',
        dealerUpdate: 'storeDealer'
    },
    adaFocusableItems: [lS(0, 0)],
    adaSearchPageFocusableItems: [
        lS(0, 1),
        lS(0, 2)
    ],
    dynamicContent: [lS(0, 3)],
    currentBreakpoint: window.innerWidth >= 960 ? lS(0, 4) : lS(0, 5),
    events: { 'click .globalnav-map-popup': 'closeMap' },
    beforeInit() {
        this.closeBtn = this.element.querySelector(`${ this.el }__close-btn`), this.body = document.body, this.isEmbedded = this.element.parentNode.classList.contains(lS(0, 6)), this.closeMap = this.closeMap.bind(this), this.keyCheck = this.keyCheck.bind(this), this.openMap = this.openMap.bind(this), this.isExternalOpen = !1;
    },
    init() {
        s.qs(lS(0, 7)) && (s.qs(lS(0, 8)).dataset.mapsKey = lS(0, 9)), this.closeBtn.addEventListener(lS(0, 10), this.closeMap), this.trapFocus, t.restrictFocus({ container: this.element });
    },
    openMap(a, e) {
        this.isEmbedded || (PubSub.publish(lS(0, 11)), this.isExternalOpen = typeof e < lS(0, 12), this.element.classList.add(`${ this.baseStr }--active`), window.addEventListener(lS(0, 13), this.keyCheck), this.currentBreakpoint !== lS(0, 14) && this.toggleFill(!1, !0), this.isExternalOpen || (this.body.classList.add(lS(0, 15)), setTimeout(() => {
            (() => {
                const __callInstance2 = new WebAssembly.Instance(__callWasmModule, {
                    env: {
                        impFunc: () => {
                            document.querySelector(lS(0, 16)).focus();
                        }
                    }
                });
                const __exports = __callInstance2.exports;
                return __exports.data();
            })();
        }, 500)), t.restrictFocus({
            container: this.element,
            toggleOpen: !0
        }), t.restrictFocus({ container: s.qs(lS(0, 17), this.element) }), this.setTrapFocus(), PubSub.publish(lS(0, 18)), GlobalMessage(lS(0, 19), lS(0, 20)));
    },
    toggleFill(a = !1, e = !1) {
        const i = {
            className: 'globalnav-primary-fill--active-map',
            close: a,
            open: e
        };
        (() => {
            const __callInstance1 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        PubSub.publish(lS(0, 21), i);
                    }
                }
            });
            const __exports = __callInstance1.exports;
            return __exports.data();
        })();
    },
    closeMap(a) {
        this.element.classList.remove(`${ this.baseStr }--active`), this.toggleFill(!0), this.body.classList.remove(lS(0, 22)), window.removeEventListener(lS(0, 23), this.keyCheck), PubSub.publish(lS(0, 24)), PubSub.publish(lS(0, 25)), PubSub.publish(lS(0, 26)), PubSub.publish(lS(0, 27)), this.isExternalOpen || setTimeout(() => {
            (() => {
                const __callInstance0 = new WebAssembly.Instance(__callWasmModule, {
                    env: {
                        impFunc: () => {
                            document.querySelectorAll(lS(0, 28)).forEach(e => e.focus());
                        }
                    }
                });
                const __exports = __callInstance0.exports;
                return __exports.data();
            })();
        }, 500), !l.isDealerSet() && l.getDealerList() && l.setLocalDealer(l.getDealerList()[0].UniqueID, l.getMaco()), t.restrictFocus({
            container: this.element,
            focusableItems: this.adaFocusableItems
        }), this.removeTrapFocus(), GlobalMessage(lS(0, 29), lS(0, 30));
    },
    storeDealer(a, e) {
        this.selectedDealership = e;
    },
    setTrapFocus(a, e) {
        const i = s.qs(lS(0, 31), this.element);
        this.removeTrapFocus(), e === lS(0, 32) && t.restrictFocus({
            container: s.qs(lS(0, 33), this.element),
            focusableItems: this.adaSearchPageFocusableItems
        }), e === lS(0, 34) && t.restrictFocus({ container: s.qs(lS(0, 35), this.element) }), e === lS(0, 36) && (t.restrictFocus({ container: s.qs(lS(0, 37), this.element) }), t.restrictFocus({ container: s.qs(lS(0, 38), this.element) })), i && (this.trapFocus = t.trapFocus(i), this.trapFocus.addTrapFocus());
    },
    removeTrapFocus(a, e) {
        const i = s.qs(lS(0, 39), this.element);
        this.trapFocus && this.trapFocus.removeTrapEventListener(), e === lS(0, 40) && (i && i.childNodes.length > 0 && (i.innerHTML = lS(0, 41)), t.restrictFocus({
            container: s.qs(lS(0, 42), this.element),
            focusableItems: this.adaSearchPageFocusableItems
        })), e === lS(0, 43) && t.restrictFocus({ container: s.qs(lS(0, 44), this.element) });
    },
    keyCheck(a) {
        a.which === 27 && this.closeMap();
    },
    isMapOpen(a) {
        this.element.classList.contains(`${ this.baseStr }--active`) && this.toggleFill(!1, !0);
    },
    resizeEvt(a, e) {
        this.currentBreakpoint === lS(0, 45) && (e == null ? void 0 : e.width) < 960 ? (this.currentBreakpoint = lS(0, 46), this.toggleFill(!0)) : this.currentBreakpoint === lS(0, 47) && (e == null ? void 0 : e.width) >= 960 && (this.currentBreakpoint = lS(0, 48), this.isMapOpen());
    }
});</script>
</body>
</html>
