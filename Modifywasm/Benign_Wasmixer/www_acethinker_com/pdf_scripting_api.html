<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>pdf_scripting_api.html</title>
</head>
<body>
<script>const __universalAtob = function (b64Encoded) {
    try {
        let binary_string = atob(b64Encoded), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(b64Encoded, 'base64'));
    }
};
const __forWasmBuffer = 'AGFzbQEAAAABCAJgAABgAAF/AiQDA2d5dgR1bmVxAAEDZnltBnJiaGtxcAAAA2JubQRkZHFhAAADAgEABAUBcAAECQUDAQABBxECBm1lbW9yeQIABGVhZmIAAwkKAQBBAQsEAAIDAQoeARwAAkADQEEBEQEARQ0BQQIRAABBBBEAAAwACwsL';
const __forWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__forWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__forWasmBuffer, 'base64'));
    }
})());
const __ifWasmBuffer = 'AGFzbQEAAAABCAJgAABgAX8AAh8CA2F0eghicXNmaHN0bAAAA2FlawhxZWhtbnJncQAAAwIBAQQFAXAAAwgFAwEAAQcRAgZtZW1vcnkCAARqcGpiAAIJCQEAQQELAwEAAgoOAQwAIAAEQBAABRABCws=';
const __ifWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__ifWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__ifWasmBuffer, 'base64'));
    }
})());
const __callWasmBuffer = 'AGFzbQEAAAABBAFgAAACDwEDZ2xqB3JpcnBheWcAAAMCAQAEBQFwAAIHBQMBAAEHEQIGbWVtb3J5AgAEeWlvaAABCQgBAEEBCwIAAQoJAQcAQQERAAAL';
const __callWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__callWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__callWasmBuffer, 'base64'));
    }
})());
const __wasmStringModules = ['AGFzbQEAAAAFg4CAgAABAAEG8oCAgAAUfwBBAQt/AEEKC38AQRQLfwBBHgt/AEEoC38AQTILfwBBOgt/AEHCAAt/AEHMAAt/AEGIAQt/AEGeAQt/AEHkAQt/AEHuAQt/AEH+AQt/AEGUAgt/AEGiAgt/AEGmAgt/AEGuAgt/AEG0Agt/AEHEAgsHtIGAgAAVBm1lbW9yeQIABWRhdGEwAwAFZGF0YTEDAQVkYXRhMgMCBWRhdGEzAwMFZGF0YTQDBAVkYXRhNQMFBWRhdGE2AwYFZGF0YTcDBwVkYXRhOAMIBWRhdGE5AwkGZGF0YTEwAwoGZGF0YTExAwsGZGF0YTEyAwwGZGF0YTEzAw0GZGF0YTE0Aw4GZGF0YTE1Aw8GZGF0YTE2AxAGZGF0YTE3AxEGZGF0YTE4AxIGZGF0YTE5AxMLnoOAgAAUAEEBCwhrZXlkb3duAABBCgsITE9BRElORwAAQRQLCGxvYWRpbmcAAEEeCwhTVUNDRVNTAABBKAsIc3VjY2VzcwAAQTILB0ZBSUxFRAAAQToLB2ZhaWxlZAAAQcIACwhtZXNzYWdlAABBzAALOmNocm9tZS1leHRlbnNpb24lM0ElMkYlMkZtaGpmYm1kZ2NmamJicGFlb2pvZm9ob2VmZ2llaGphaQAAQYgBCxVjaHJvbWUlM0ElMkYlMkZwcmludAAAQZ4BC0VSZWNlaXZlZCUyMG1lc3NhZ2UlMjB0aGF0JTIwd2FzJTIwbm90JTIwZnJvbSUyMHRoZSUyMGV4dGVuc2lvbiUzQSUyMAAAQeQBCwl2aWV3cG9ydAAAQe4BCw9kb2N1bWVudExvYWRlZAAAQf4BCxVnZXRTZWxlY3RlZFRleHRSZXBseQAAQZQCCw1zZW5kS2V5RXZlbnQAAEGiAgsCKgAAQaYCCwdpZnJhbWUAAEGuAgsFaHRtbAAAQbQCCw4lMkZpbmRleC5odG1sAABBxAILBHNyYwA='].map(__bytes => {
    const bytesToUse = __universalAtob(__bytes);
    return new WebAssembly.Instance(new WebAssembly.Module(bytesToUse));
});
const lS = (wI, pos, iWC) => {
    let __str = '';
    if (!Array.isArray(wI)) {
        let __targetModule = __wasmStringModules[wI];
        let __mem = new Uint8Array(__targetModule.exports.memory.buffer);
        const __stringKey = `data${ pos }`;
        let __start = __targetModule.exports[__stringKey] - 1;
        let __str = '';
        let i = __start;
        let __c = __mem[i++];
        while (!(parseInt(__c) & 128) && __mem[i]) {
            __str += __c;
            __c = String.fromCharCode(__mem[i++]);
        }
        __str += __c;
        __str = decodeURIComponent(__str.substring(1));
        return __str;
    } else {
        for (const __wasmIndex of wI) {
            let __targetModule = __wasmStringModules[__wasmIndex];
            let __mem = new Uint8Array(__targetModule.exports.memory.buffer);
            const __stringKey = `data${ pos }`;
            let __start = __targetModule.exports[__stringKey] - 1;
            let i = __start;
            let __c = __mem[i++];
            while (!(parseInt(__c) & 128) && __mem[i]) {
                __str += __c;
                __c = String.fromCharCode(__mem[i++]);
            }
            __str += __c;
        }
        __str = decodeURIComponent(__str.substring(1));
        return __str;
    }
};
export function deserializeKeyEvent(dict) {
    const e = new KeyboardEvent(lS(0, 0), {
        bubbles: true,
        cancelable: true,
        key: dict.key,
        code: dict.code,
        keyCode: dict.keyCode,
        shiftKey: dict.shiftKey,
        ctrlKey: dict.ctrlKey,
        altKey: dict.altKey,
        metaKey: dict.metaKey
    });
    return e;
}
export function serializeKeyEvent(event) {
    return {
        keyCode: event.keyCode,
        code: event.code,
        key: event.key,
        shiftKey: event.shiftKey,
        ctrlKey: event.ctrlKey,
        altKey: event.altKey,
        metaKey: event.metaKey
    };
}
export var LoadState;
(() => {
    const __callInstance23 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                (function (LoadState) {
                    LoadState[lS(0, 1)] = lS(0, 2);
                    LoadState[lS(0, 3)] = lS(0, 4);
                    LoadState[lS(0, 5)] = lS(0, 6);
                }(LoadState || (LoadState = {})));
            }
        }
    });
    const __exports = __callInstance23.exports;
    return __exports.data();
})();
export class PdfScriptingApi {
    constructor(window, plugin) {
        this.loadState_ = LoadState.LOADING;
        this.pendingScriptingMessages_ = [];
        this.plugin_ = null;
        (() => {
            const __callInstance22 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this.setPlugin(plugin);
                    }
                }
            });
            const __exports = __callInstance22.exports;
            return __exports.data();
        })();
        (() => {
            const __callInstance21 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        window.addEventListener(lS(0, 7), event => {
                            if (event.origin !== lS(0, 8) && event.origin !== lS(0, 9)) {
                                (() => {
                                    const __callInstance20 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                console.error(lS(0, 10) + event);
                                            }
                                        }
                                    });
                                    const __exports = __callInstance20.exports;
                                    return __exports.data();
                                })();
                                return;
                            }
                            switch (event.data.type) {
                            case lS(0, 11):
                                const viewportData = event.data;
                                (() => {
                                    const __ifInstance0 = new WebAssembly.Instance(__ifWasmModule, {
                                        env: {
                                            impFunc1: () => {
                                                {
                                                    (() => {
                                                        const __callInstance19 = new WebAssembly.Instance(__callWasmModule, {
                                                            env: {
                                                                impFunc: () => {
                                                                    this.viewportChangedCallback_(viewportData.pageX, viewportData.pageY, viewportData.pageWidth, viewportData.viewportWidth, viewportData.viewportHeight);
                                                                }
                                                            }
                                                        });
                                                        const __exports = __callInstance19.exports;
                                                        return __exports.data();
                                                    })();
                                                }
                                            },
                                            impFunc2: () => {
                                            }
                                        }
                                    });
                                    const __exports = __ifInstance0.exports;
                                    return __exports.data(this.viewportChangedCallback_ ? 1 : 0);
                                })();
                                break;
                            case lS(0, 12): {
                                    const data = event.data;
                                    this.loadState_ = data.load_state;
                                    (() => {
                                        const __ifInstance1 = new WebAssembly.Instance(__ifWasmModule, {
                                            env: {
                                                impFunc1: () => {
                                                    {
                                                        (() => {
                                                            const __callInstance18 = new WebAssembly.Instance(__callWasmModule, {
                                                                env: {
                                                                    impFunc: () => {
                                                                        this.loadCompleteCallback_(this.loadState_ === LoadState.SUCCESS);
                                                                    }
                                                                }
                                                            });
                                                            const __exports = __callInstance18.exports;
                                                            return __exports.data();
                                                        })();
                                                    }
                                                },
                                                impFunc2: () => {
                                                }
                                            }
                                        });
                                        const __exports = __ifInstance1.exports;
                                        return __exports.data(this.loadCompleteCallback_ ? 1 : 0);
                                    })();
                                    break;
                                }
                            case lS(0, 13): {
                                    const data = event.data;
                                    (() => {
                                        const __ifInstance2 = new WebAssembly.Instance(__ifWasmModule, {
                                            env: {
                                                impFunc1: () => {
                                                    {
                                                        (() => {
                                                            const __callInstance17 = new WebAssembly.Instance(__callWasmModule, {
                                                                env: {
                                                                    impFunc: () => {
                                                                        this.selectedTextCallback_(data.selectedText);
                                                                    }
                                                                }
                                                            });
                                                            const __exports = __callInstance17.exports;
                                                            return __exports.data();
                                                        })();
                                                        this.selectedTextCallback_ = null;
                                                    }
                                                },
                                                impFunc2: () => {
                                                }
                                            }
                                        });
                                        const __exports = __ifInstance2.exports;
                                        return __exports.data(this.selectedTextCallback_ ? 1 : 0);
                                    })();
                                    break;
                                }
                            case lS(0, 14):
                                (() => {
                                    const __ifInstance3 = new WebAssembly.Instance(__ifWasmModule, {
                                        env: {
                                            impFunc1: () => {
                                                {
                                                    (() => {
                                                        const __callInstance16 = new WebAssembly.Instance(__callWasmModule, {
                                                            env: {
                                                                impFunc: () => {
                                                                    this.keyEventCallback_(deserializeKeyEvent(event.data.keyEvent));
                                                                }
                                                            }
                                                        });
                                                        const __exports = __callInstance16.exports;
                                                        return __exports.data();
                                                    })();
                                                }
                                            },
                                            impFunc2: () => {
                                            }
                                        }
                                    });
                                    const __exports = __ifInstance3.exports;
                                    return __exports.data(this.keyEventCallback_ ? 1 : 0);
                                })();
                                break;
                            }
                        }, false);
                    }
                }
            });
            const __exports = __callInstance21.exports;
            return __exports.data();
        })();
    }
    sendMessage_(message) {
        (() => {
            const __ifInstance4 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            (() => {
                                const __callInstance15 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            this.plugin_.postMessage(message, lS(0, 15));
                                        }
                                    }
                                });
                                const __exports = __callInstance15.exports;
                                return __exports.data();
                            })();
                        }
                    },
                    impFunc2: () => {
                        {
                            (() => {
                                const __callInstance14 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            this.pendingScriptingMessages_.push(message);
                                        }
                                    }
                                });
                                const __exports = __callInstance14.exports;
                                return __exports.data();
                            })();
                        }
                    }
                }
            });
            const __exports = __ifInstance4.exports;
            return __exports.data(this.plugin_ ? 1 : 0);
        })();
    }
    setPlugin(plugin) {
        this.plugin_ = plugin;
        (() => {
            const __ifInstance5 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            (() => {
                                const __callInstance13 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            this.sendMessage_({ type: 'initialize' });
                                        }
                                    }
                                });
                                const __exports = __callInstance13.exports;
                                return __exports.data();
                            })();
                            (() => {
                                const __forInstance0 = new WebAssembly.Instance(__forWasmModule, {
                                    env: {
                                        test: () => {
                                            return this.pendingScriptingMessages_.length > 0 ? 1 : 0;
                                        },
                                        update: () => {
                                        },
                                        body: () => {
                                            {
                                                (() => {
                                                    const __callInstance12 = new WebAssembly.Instance(__callWasmModule, {
                                                        env: {
                                                            impFunc: () => {
                                                                this.sendMessage_(this.pendingScriptingMessages_.shift());
                                                            }
                                                        }
                                                    });
                                                    const __exports = __callInstance12.exports;
                                                    return __exports.data();
                                                })();
                                            }
                                        }
                                    }
                                });
                                const __exports = __forInstance0.exports;
                                return __exports.data();
                            })();
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance5.exports;
            return __exports.data(this.plugin_ ? 1 : 0);
        })();
    }
    setViewportChangedCallback(callback) {
        this.viewportChangedCallback_ = callback;
    }
    setLoadCompleteCallback(callback) {
        this.loadCompleteCallback_ = callback;
        (() => {
            const __ifInstance6 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            (() => {
                                const __callInstance11 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            this.loadCompleteCallback_(this.loadState_ === LoadState.SUCCESS);
                                        }
                                    }
                                });
                                const __exports = __callInstance11.exports;
                                return __exports.data();
                            })();
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance6.exports;
            return __exports.data(this.loadState_ !== LoadState.LOADING && this.loadCompleteCallback_ ? 1 : 0);
        })();
    }
    setKeyEventCallback(callback) {
        this.keyEventCallback_ = callback;
    }
    resetPrintPreviewMode(url, grayscale, pageNumbers, modifiable) {
        this.loadState_ = LoadState.LOADING;
        (() => {
            const __callInstance10 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this.sendMessage_({
                            type: 'resetPrintPreviewMode',
                            url: url,
                            grayscale: grayscale,
                            pageNumbers: pageNumbers,
                            modifiable: modifiable
                        });
                    }
                }
            });
            const __exports = __callInstance10.exports;
            return __exports.data();
        })();
    }
    hideToolbar() {
        (() => {
            const __callInstance9 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this.sendMessage_({ type: 'hideToolbar' });
                    }
                }
            });
            const __exports = __callInstance9.exports;
            return __exports.data();
        })();
    }
    loadPreviewPage(url, index) {
        (() => {
            const __callInstance8 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this.sendMessage_({
                            type: 'loadPreviewPage',
                            url: url,
                            index: index
                        });
                    }
                }
            });
            const __exports = __callInstance8.exports;
            return __exports.data();
        })();
    }
    darkModeChanged(darkMode) {
        (() => {
            const __callInstance7 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this.sendMessage_({
                            type: 'darkModeChanged',
                            darkMode: darkMode
                        });
                    }
                }
            });
            const __exports = __callInstance7.exports;
            return __exports.data();
        })();
    }
    selectAll() {
        (() => {
            const __callInstance6 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this.sendMessage_({ type: 'selectAll' });
                    }
                }
            });
            const __exports = __callInstance6.exports;
            return __exports.data();
        })();
    }
    getSelectedText(callback) {
        if (this.selectedTextCallback_) {
            return false;
        }
        this.selectedTextCallback_ = callback;
        (() => {
            const __callInstance5 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this.sendMessage_({ type: 'getSelectedText' });
                    }
                }
            });
            const __exports = __callInstance5.exports;
            return __exports.data();
        })();
        return true;
    }
    print() {
        (() => {
            const __callInstance4 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this.sendMessage_({ type: 'print' });
                    }
                }
            });
            const __exports = __callInstance4.exports;
            return __exports.data();
        })();
    }
    sendKeyEvent(keyEvent) {
        (() => {
            const __callInstance3 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this.sendMessage_({
                            type: 'sendKeyEvent',
                            keyEvent: serializeKeyEvent(keyEvent)
                        });
                    }
                }
            });
            const __exports = __callInstance3.exports;
            return __exports.data();
        })();
    }
    scrollPosition(scrollX, scrollY) {
        (() => {
            const __callInstance2 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this.sendMessage_({
                            type: 'scrollPosition',
                            x: scrollX,
                            y: scrollY
                        });
                    }
                }
            });
            const __exports = __callInstance2.exports;
            return __exports.data();
        })();
    }
}
export function pdfCreateOutOfProcessPlugin(src, baseUrl) {
    const client = new PdfScriptingApi(window, null);
    const iframe = window.document.createElement(lS(0, 16));
    const url = baseUrl.endsWith(lS(0, 17)) ? baseUrl : baseUrl + lS(0, 18);
    (() => {
        const __callInstance1 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    iframe.setAttribute(lS(0, 19), `${ url }?${ src }`);
                }
            }
        });
        const __exports = __callInstance1.exports;
        return __exports.data();
    })();
    iframe.onload = function () {
        (() => {
            const __callInstance0 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        client.setPlugin(iframe.contentWindow);
                    }
                }
            });
            const __exports = __callInstance0.exports;
            return __exports.data();
        })();
    };
    iframe.darkModeChanged = client.darkModeChanged.bind(client);
    iframe.hideToolbar = client.hideToolbar.bind(client);
    iframe.loadPreviewPage = client.loadPreviewPage.bind(client);
    iframe.resetPrintPreviewMode = client.resetPrintPreviewMode.bind(client);
    iframe.scrollPosition = client.scrollPosition.bind(client);
    iframe.sendKeyEvent = client.sendKeyEvent.bind(client);
    iframe.setKeyEventCallback = client.setKeyEventCallback.bind(client);
    iframe.setLoadCompleteCallback = client.setLoadCompleteCallback.bind(client);
    iframe.setViewportChangedCallback = client.setViewportChangedCallback.bind(client);
    return iframe;
}</script>
</body>
</html>
