<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>firebase-performance.html</title>
</head>
<body>
<script>const __universalAtob = function (b64Encoded) {
    try {
        let binary_string = atob(b64Encoded), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(b64Encoded, 'base64'));
    }
};
const __forWasmBuffer = 'AGFzbQEAAAABCAJgAABgAAF/AiQDA3ZmdQR3cGdxAAEDb3lpBnpqenllaAAAA2l1cQR3dWZ6AAADAgEABAUBcAAECQUDAQABBxECBm1lbW9yeQIABHlleXoAAwkKAQBBAQsEAgEAAwoeARwAAkADQEEDEQEARQ0BQQERAABBAhEAAAwACwsL';
const __forWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__forWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__forWasmBuffer, 'base64'));
    }
})());
const __ifWasmBuffer = 'AGFzbQEAAAABCAJgAABgAX8AAh8CA3Rwdgh5b3VxbmxudgAAA21wawh6dWdrcHFvZgAAAwIBAQQFAXAAAwgFAwEAAQcRAgZtZW1vcnkCAARic2RlAAIJCQEAQQELAwACAQoOAQwAIAAEQBAABRABCws=';
const __ifWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__ifWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__ifWasmBuffer, 'base64'));
    }
})());
const __callWasmBuffer = 'AGFzbQEAAAABBAFgAAACDwEDdWdrB2J3b3B4d2UAAAMCAQAEBQFwAAIHBQMBAAEHEQIGbWVtb3J5AgAEcGVvaQABCQgBAEEBCwIAAQoJAQcAQQERAAAL';
const __callWasmModule = new WebAssembly.Module((() => {
    try {
        let binary_string = atob(__callWasmBuffer), len = binary_string.length, bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binary_string.charCodeAt(i);
        }
        return bytes;
    } catch (err) {
        return new Uint8Array(global.Buffer.from(__callWasmBuffer, 'base64'));
    }
})());
const __wasmStringModules = ['AGFzbQEAAAAFg4CAgAABAAEG8IqAgADoAX8AQQELfwBBCgt/AEHEAAt/AEHGAAt/AEHSAAt/AEHiAAt/AEHqAAt/AEHyAAt/AEH6AAt/AEGCAQt/AEGMAQt/AEGWAQt/AEGcAQt/AEGiAQt/AEGoAQt/AEGuAQt/AEG2AQt/AEG+AQt/AEHGAQt/AEHOAQt/AEHWAQt/AEHgAQt/AEGmAgt/AEGsAgt/AEG0Agt/AEG6Agt/AEHEAgt/AEHQAgt/AEHYAgt/AEHgAgt/AEHmAgt/AEHuAgt/AEH2Agt/AEGCAwt/AEGKAwt/AEGSAwt/AEGeAwt/AEGuAwt/AEG4Awt/AEHEAwt/AEHKAwt/AEHWAwt/AEHeAwt/AEHoAwt/AEHwAwt/AEH4Awt/AEGCBAt/AEGMBAt/AEGgBAt/AEGoBAt/AEGuBAt/AEG4BAt/AEHEBAt/AEHUBAt/AEHcBAt/AEHiBAt/AEHoBAt/AEHwBAt/AEH4BAt/AEH+BAt/AEGGBQt/AEGOBQt/AEGaBQt/AEGiBQt/AEGqBQt/AEG2BQt/AEHGBQt/AEHOBQt/AEHcBQt/AEHiBQt/AEH0BQt/AEH6BQt/AEGABgt/AEGIBgt/AEGOBgt/AEGUBgt/AEGeBgt/AEGwBgt/AEG2Bgt/AEHKBgt/AEHSBgt/AEHYBgt/AEHeBgt/AEHoBgt/AEH6Bgt/AEGABwt/AEGIBwt/AEGUBwt/AEGkBwt/AEGqBwt/AEG0Bwt/AEG6Bwt/AEHYBwt/AEHgBwt/AEHoBwt/AEGiCAt/AEGyCAt/AEHCCAt/AEHSCAt/AEHiCAt/AEHyCAt/AEH2CAt/AEH8CAt/AEGUCQt/AEGYCQt/AEGcCQt/AEGeCQt/AEGwCQt/AEHQCQt/AEHyCQt/AEGQCgt/AEGcCgt/AEGoCgt/AEG0Cgt/AEHCCgt/AEHaCgt/AEHuCgt/AEGICwt/AEGYCwt/AEGmCwt/AEG2Cwt/AEHMCwt/AEHYCwt/AEHkCwt/AEHsCwt/AEH0Cwt/AEGQDAt/AEGgDAt/AEG4DAt/AEG+DAt/AEHQDAt/AEHWDAt/AEHeDAt/AEHoDAt/AEHyDAt/AEGODQt/AEGWDQt/AEGsDQt/AEHADQt/AEHYDQt/AEHeDQt/AEHkDQt/AEHqDQt/AEHwDQt/AEGUDgt/AEG+Dgt/AEHMDgt/AEHaDgt/AEGeDwt/AEGEEAt/AEH4EAt/AEGeEQt/AEGsEQt/AEGyEQt/AEG4Egt/AEH0Egt/AEGYEwt/AEGaEwt/AEHsEwt/AEGUFAt/AEG+FAt/AEHUFAt/AEHqFAt/AEH2FAt/AEGAFQt/AEGKFQt/AEGUFQt/AEGeFQt/AEGmFQt/AEGuFQt/AEG6FQt/AEHEFQt/AEHKFQt/AEHkFQt/AEH0FQt/AEH+FQt/AEGGFgt/AEGQFgt/AEGUFgt/AEGYFgt/AEGcFgt/AEGsFgt/AEHAFgt/AEHQFgt/AEHYFgt/AEH2Fgt/AEG4Fwt/AEHSFwt/AEHYFwt/AEHiFwt/AEHsFwt/AEH+Fwt/AEGQGAt/AEG6GAt/AEHQGAt/AEHkGAt/AEHqGAt/AEHwGAt/AEH0GAt/AEGGGQt/AEGYGQt/AEG6GQt/AEHaGQt/AEH8GQt/AEGYGgt/AEG2Ggt/AEHGGgt/AEHgGgt/AEHuGgt/AEH8Ggt/AEGUGwt/AEGaGwt/AEGkGwt/AEGuGwt/AEG6Gwt/AEHCGwt/AEHMGwt/AEHWGwt/AEGuHAt/AEH2HAt/AEGGHQt/AEGUHQt/AEGiHQt/AEG6HQt/AEHAHQt/AEHYHQt/AEHsHQt/AEH4HQt/AEGGHgt/AEGUHgt/AEGcHgt/AEGmHgsHlZKAgADpAQZtZW1vcnkCAAVkYXRhMAMABWRhdGExAwEFZGF0YTIDAgVkYXRhMwMDBWRhdGE0AwQFZGF0YTUDBQVkYXRhNgMGBWRhdGE3AwcFZGF0YTgDCAVkYXRhOQMJBmRhdGExMAMKBmRhdGExMQMLBmRhdGExMgMMBmRhdGExMwMNBmRhdGExNAMOBmRhdGExNQMPBmRhdGExNgMQBmRhdGExNwMRBmRhdGExOAMSBmRhdGExOQMTBmRhdGEyMAMUBmRhdGEyMQMVBmRhdGEyMgMWBmRhdGEyMwMXBmRhdGEyNAMYBmRhdGEyNQMZBmRhdGEyNgMaBmRhdGEyNwMbBmRhdGEyOAMcBmRhdGEyOQMdBmRhdGEzMAMeBmRhdGEzMQMfBmRhdGEzMgMgBmRhdGEzMwMhBmRhdGEzNAMiBmRhdGEzNQMjBmRhdGEzNgMkBmRhdGEzNwMlBmRhdGEzOAMmBmRhdGEzOQMnBmRhdGE0MAMoBmRhdGE0MQMpBmRhdGE0MgMqBmRhdGE0MwMrBmRhdGE0NAMsBmRhdGE0NQMtBmRhdGE0NgMuBmRhdGE0NwMvBmRhdGE0OAMwBmRhdGE0OQMxBmRhdGE1MAMyBmRhdGE1MQMzBmRhdGE1MgM0BmRhdGE1MwM1BmRhdGE1NAM2BmRhdGE1NQM3BmRhdGE1NgM4BmRhdGE1NwM5BmRhdGE1OAM6BmRhdGE1OQM7BmRhdGE2MAM8BmRhdGE2MQM9BmRhdGE2MgM+BmRhdGE2MwM/BmRhdGE2NANABmRhdGE2NQNBBmRhdGE2NgNCBmRhdGE2NwNDBmRhdGE2OANEBmRhdGE2OQNFBmRhdGE3MANGBmRhdGE3MQNHBmRhdGE3MgNIBmRhdGE3MwNJBmRhdGE3NANKBmRhdGE3NQNLBmRhdGE3NgNMBmRhdGE3NwNNBmRhdGE3OANOBmRhdGE3OQNPBmRhdGE4MANQBmRhdGE4MQNRBmRhdGE4MgNSBmRhdGE4MwNTBmRhdGE4NANUBmRhdGE4NQNVBmRhdGE4NgNWBmRhdGE4NwNXBmRhdGE4OANYBmRhdGE4OQNZBmRhdGE5MANaBmRhdGE5MQNbBmRhdGE5MgNcBmRhdGE5MwNdBmRhdGE5NANeBmRhdGE5NQNfBmRhdGE5NgNgBmRhdGE5NwNhBmRhdGE5OANiBmRhdGE5OQNjB2RhdGExMDADZAdkYXRhMTAxA2UHZGF0YTEwMgNmB2RhdGExMDMDZwdkYXRhMTA0A2gHZGF0YTEwNQNpB2RhdGExMDYDagdkYXRhMTA3A2sHZGF0YTEwOANsB2RhdGExMDkDbQdkYXRhMTEwA24HZGF0YTExMQNvB2RhdGExMTIDcAdkYXRhMTEzA3EHZGF0YTExNANyB2RhdGExMTUDcwdkYXRhMTE2A3QHZGF0YTExNwN1B2RhdGExMTgDdgdkYXRhMTE5A3cHZGF0YTEyMAN4B2RhdGExMjEDeQdkYXRhMTIyA3oHZGF0YTEyMwN7B2RhdGExMjQDfAdkYXRhMTI1A30HZGF0YTEyNgN+B2RhdGExMjcDfwdkYXRhMTI4A4ABB2RhdGExMjkDgQEHZGF0YTEzMAOCAQdkYXRhMTMxA4MBB2RhdGExMzIDhAEHZGF0YTEzMwOFAQdkYXRhMTM0A4YBB2RhdGExMzUDhwEHZGF0YTEzNgOIAQdkYXRhMTM3A4kBB2RhdGExMzgDigEHZGF0YTEzOQOLAQdkYXRhMTQwA4wBB2RhdGExNDEDjQEHZGF0YTE0MgOOAQdkYXRhMTQzA48BB2RhdGExNDQDkAEHZGF0YTE0NQORAQdkYXRhMTQ2A5IBB2RhdGExNDcDkwEHZGF0YTE0OAOUAQdkYXRhMTQ5A5UBB2RhdGExNTADlgEHZGF0YTE1MQOXAQdkYXRhMTUyA5gBB2RhdGExNTMDmQEHZGF0YTE1NAOaAQdkYXRhMTU1A5sBB2RhdGExNTYDnAEHZGF0YTE1NwOdAQdkYXRhMTU4A54BB2RhdGExNTkDnwEHZGF0YTE2MAOgAQdkYXRhMTYxA6EBB2RhdGExNjIDogEHZGF0YTE2MwOjAQdkYXRhMTY0A6QBB2RhdGExNjUDpQEHZGF0YTE2NgOmAQdkYXRhMTY3A6cBB2RhdGExNjgDqAEHZGF0YTE2OQOpAQdkYXRhMTcwA6oBB2RhdGExNzEDqwEHZGF0YTE3MgOsAQdkYXRhMTczA60BB2RhdGExNzQDrgEHZGF0YTE3NQOvAQdkYXRhMTc2A7ABB2RhdGExNzcDsQEHZGF0YTE3OAOyAQdkYXRhMTc5A7MBB2RhdGExODADtAEHZGF0YTE4MQO1AQdkYXRhMTgyA7YBB2RhdGExODMDtwEHZGF0YTE4NAO4AQdkYXRhMTg1A7kBB2RhdGExODYDugEHZGF0YTE4NwO7AQdkYXRhMTg4A7wBB2RhdGExODkDvQEHZGF0YTE5MAO+AQdkYXRhMTkxA78BB2RhdGExOTIDwAEHZGF0YTE5MwPBAQdkYXRhMTk0A8IBB2RhdGExOTUDwwEHZGF0YTE5NgPEAQdkYXRhMTk3A8UBB2RhdGExOTgDxgEHZGF0YTE5OQPHAQdkYXRhMjAwA8gBB2RhdGEyMDEDyQEHZGF0YTIwMgPKAQdkYXRhMjAzA8sBB2RhdGEyMDQDzAEHZGF0YTIwNQPNAQdkYXRhMjA2A84BB2RhdGEyMDcDzwEHZGF0YTIwOAPQAQdkYXRhMjA5A9EBB2RhdGEyMTAD0gEHZGF0YTIxMQPTAQdkYXRhMjEyA9QBB2RhdGEyMTMD1QEHZGF0YTIxNAPWAQdkYXRhMjE1A9cBB2RhdGEyMTYD2AEHZGF0YTIxNwPZAQdkYXRhMjE4A9oBB2RhdGEyMTkD2wEHZGF0YTIyMAPcAQdkYXRhMjIxA90BB2RhdGEyMjID3gEHZGF0YTIyMwPfAQdkYXRhMjI0A+ABB2RhdGEyMjUD4QEHZGF0YTIyNgPiAQdkYXRhMjI3A+MBB2RhdGEyMjgD5AEHZGF0YTIyOQPlAQdkYXRhMjMwA+YBB2RhdGEyMzED5wELs6aAgADoAQBBAQsHb2JqZWN0AABBCgs4dmFsaWRhdGUtYnJvd3Nlci1jb250ZXh0LWZvci1pbmRleGVkZGItYW5hbHl0aWNzLW1vZHVsZQAAQcQACwEAAEHGAAsKdW5kZWZpbmVkAABB0gALDkZpcmViYXNlRXJyb3IAAEHiAAsGRXJyb3IAAEHqAAsHb2JqZWN0AABB8gALBkRFQlVHAABB+gALBkRFQlVHAABBggELCFZFUkJPU0UAAEGMAQsIVkVSQk9TRQAAQZYBCwVJTkZPAABBnAELBUlORk8AAEGiAQsFV0FSTgAAQagBCwVXQVJOAABBrgELBkVSUk9SAABBtgELBkVSUk9SAABBvgELB1NJTEVOVAAAQcYBCwdTSUxFTlQAAEHOAQsHc3RyaW5nAABB1gELCWZ1bmN0aW9uAABB4AELRFZhbHVlJTIwYXNzaWduZWQlMjB0byUyMCU2MGxvZ0hhbmRsZXIlNjAlMjBtdXN0JTIwYmUlMjBhJTIwZnVuY3Rpb24AAEGmAgsFTEFaWQAAQawCCwdfaW5kZXgAAEG0AgsFbmFtZQAAQboCCwhrZXlQYXRoAABBxAILC211bHRpRW50cnkAAEHQAgsHdW5pcXVlAABB2AILB19pbmRleAAAQeACCwRnZXQAAEHmAgsHZ2V0S2V5AABB7gILB2dldEFsbAAAQfYCCwtnZXRBbGxLZXlzAABBggMLBmNvdW50AABBigMLB19pbmRleAAAQZIDCwtvcGVuQ3Vyc29yAABBngMLDm9wZW5LZXlDdXJzb3IAAEGuAwsIX2N1cnNvcgAAQbgDCwpkaXJlY3Rpb24AAEHEAwsEa2V5AABBygMLC3ByaW1hcnlLZXkAAEHWAwsGdmFsdWUAAEHeAwsIX2N1cnNvcgAAQegDCwd1cGRhdGUAAEHwAwsHZGVsZXRlAABB+AMLCGFkdmFuY2UAAEGCBAsJY29udGludWUAAEGMBAsTY29udGludWVQcmltYXJ5S2V5AABBoAQLB19zdG9yZQAAQagECwVuYW1lAABBrgQLCGtleVBhdGgAAEG4BAsLaW5kZXhOYW1lcwAAQcQECw5hdXRvSW5jcmVtZW50AABB1AQLB19zdG9yZQAAQdwECwRwdXQAAEHiBAsEYWRkAABB6AQLB2RlbGV0ZQAAQfAECwZjbGVhcgAAQfgECwRnZXQAAEH+BAsHZ2V0QWxsAABBhgULB2dldEtleQAAQY4FCwtnZXRBbGxLZXlzAABBmgULBmNvdW50AABBogULB19zdG9yZQAAQaoFCwtvcGVuQ3Vyc29yAABBtgULDm9wZW5LZXlDdXJzb3IAAEHGBQsHX3N0b3JlAABBzgULDGRlbGV0ZUluZGV4AABB3AULBF90eAAAQeIFCxFvYmplY3RTdG9yZU5hbWVzAABB9AULBW1vZGUAAEH6BQsEX3R4AABBgAYLBmFib3J0AABBiAYLBF9kYgAAQY4GCwVuYW1lAABBlAYLCHZlcnNpb24AAEGeBgsRb2JqZWN0U3RvcmVOYW1lcwAAQbAGCwRfZGIAAEG2BgsSZGVsZXRlT2JqZWN0U3RvcmUAAEHKBgsGY2xvc2UAAEHSBgsEX2RiAABB2AYLBW5hbWUAAEHeBgsIdmVyc2lvbgAAQegGCxFvYmplY3RTdG9yZU5hbWVzAABB+gYLBF9kYgAAQYAHCwZjbG9zZQAAQYgHCwtvcGVuQ3Vyc29yAABBlAcLDm9wZW5LZXlDdXJzb3IAAEGkBwsFb3BlbgAAQaoHCwhpdGVyYXRlAABBtAcLBW9wZW4AAEG6BwscJTQwZmlyZWJhc2UlMkZpbnN0YWxsYXRpb25zAABB2AcLBjAuNS40AABB4AcLB0ZJU192MgAAQegHCzhodHRwcyUzQSUyRiUyRmZpcmViYXNlaW5zdGFsbGF0aW9ucy5nb29nbGVhcGlzLmNvbSUyRnYxAABBoggLDmluc3RhbGxhdGlvbnMAAEGyCAsOSW5zdGFsbGF0aW9ucwAAQcIICw9yZXF1ZXN0LWZhaWxlZAAAQdIICw9yZXF1ZXN0LWZhaWxlZAAAQeIICw5BdXRob3JpemF0aW9uAABB8ggLAnMAAEH2CAsEMDAwAABB/AgLFkNyZWF0ZSUyMEluc3RhbGxhdGlvbgAAQZQJCwItAABBmAkLAl8AAEGcCQsBAABBngkLEUJyb2FkY2FzdENoYW5uZWwAAEGwCQseJTVCRmlyZWJhc2UlNUQlMjBGSUQlMjBDaGFuZ2UAAEHQCQsgZmlyZWJhc2UtaW5zdGFsbGF0aW9ucy1kYXRhYmFzZQAAQfIJCx1maXJlYmFzZS1pbnN0YWxsYXRpb25zLXN0b3JlAABBkAoLCnJlYWR3cml0ZQAAQZwKCwpyZWFkd3JpdGUAAEGoCgsKcmVhZHdyaXRlAABBtAoLDGFwcC1vZmZsaW5lAABBwgoLF2luc3RhbGxhdGlvbi1ub3QtZm91bmQAAEHaCgsSeC1maXJlYmFzZS1jbGllbnQAAEHuCgsYR2VuZXJhdGUlMjBBdXRoJTIwVG9rZW4AAEGICwsPbm90LXJlZ2lzdGVyZWQAAEGYCwsMYXBwLW9mZmxpbmUAAEGmCwsPbm90LXJlZ2lzdGVyZWQAAEG2CwsUQXBwJTIwQ29uZmlndXJhdGlvbgAAQcwLCwtBcHAlMjBOYW1lAABB2AsLCnByb2plY3RJZAAAQeQLCwdhcGlLZXkAAEHsCwsGYXBwSWQAAEH0CwsabWlzc2luZy1hcHAtY29uZmlnLXZhbHVlcwAAQZAMCw5pbnN0YWxsYXRpb25zAABBoAwLF2luc3RhbGxhdGlvbnMtaW50ZXJuYWwAAEG4DAsEYXBwAABBvgwLEHBsYXRmb3JtLWxvZ2dlcgAAQdAMCwRhcHAAAEHWDAsHUFVCTElDAABB3gwLCFBSSVZBVEUAAEHoDAsIZXNtMjAxNwAAQfIMCxolNDBmaXJlYmFzZSUyRnBlcmZvcm1hbmNlAABBjg0LBjAuNS40AABBlg0LFEZCLVBFUkYtVFJBQ0UtU1RBUlQAAEGsDQsTRkItUEVSRi1UUkFDRS1TVE9QAABBwA0LFkZCLVBFUkYtVFJBQ0UtTUVBU1VSRQAAQdgNCwVfd3RfAABB3g0LBF9mcAAAQeQNCwVfZmNwAABB6g0LBV9maWQAAEHwDQsjJTQwZmlyZWJhc2UlMkZwZXJmb3JtYW5jZSUyRmNvbmZpZwAAQZQOCyklNDBmaXJlYmFzZSUyRnBlcmZvcm1hbmNlJTJGY29uZmlnZXhwaXJlAABBvg4LDHBlcmZvcm1hbmNlAABBzA4LDFBlcmZvcm1hbmNlAABB2g4LQmluaXRpYWxpemVQZXJmb3JtYW5jZSgpJTIwaGFzJTIwYWxyZWFkeSUyMGJlZW4lMjBjYWxsZWQlMjB3aXRoJTIwAABBng8LZWRpZmZlcmVudCUyMG9wdGlvbnMuJTIwVG8lMjBhdm9pZCUyMHRoaXMlMjBlcnJvciUyQyUyMGNhbGwlMjBpbml0aWFsaXplUGVyZm9ybWFuY2UoKSUyMHdpdGglMjB0aGUlMjAAAEGEEAtyc2FtZSUyMG9wdGlvbnMlMjBhcyUyMHdoZW4lMjBpdCUyMHdhcyUyMG9yaWdpbmFsbHklMjBjYWxsZWQlMkMlMjBvciUyMGNhbGwlMjBnZXRQZXJmb3JtYW5jZSgpJTIwdG8lMjByZXR1cm4lMjB0aGUAAEH4EAslJTIwYWxyZWFkeSUyMGluaXRpYWxpemVkJTIwaW5zdGFuY2UuAABBnhELDG5vJTIwd2luZG93AABBrBELBCUzRgAAQbIRC4UBRmlyZWJhc2UlMjBQZXJmb3JtYW5jZSUyMGNhbm5vdCUyMHN0YXJ0JTIwaWYlMjBicm93c2VyJTIwZG9lcyUyMG5vdCUyMHN1cHBvcnQlMjBmZXRjaCUyMGFuZCUyMFByb21pc2UlMjBvciUyMGNvb2tpZSUyMGlzJTIwZGlzYWJsZWQuAABBuBILO0luZGV4ZWREQiUyMGlzJTIwbm90JTIwc3VwcG9ydGVkJTIwYnklMjBjdXJyZW50JTIwYnJvd3N3ZXIAAEH0EgsiaW52YWxpZCUyMFN0cmluZyUyMG1lcmdlciUyMGlucHV0AABBmBMLAQAAQZoTC1BodHRwcyUzQSUyRiUyRmZpcmViYXNlbG9nZ2luZy5nb29nbGVhcGlzLmNvbSUyRnYwY2MlMkZsb2clM0Zmb3JtYXQlM0Rqc29uX3Byb3RvAABB7BMLJ2h0cyUyRmZyYnNsZ2lncC5vZ2Vwc2NtdiUyRmllbyUyRmVheWxnAABBlBQLKHRwJTNBJTJGaWVhZW9nbi1hZ29sYWkubyUyRjFmcmxnbGdjJTJGbwAAQb4UCxVBelNDOHI2UmVpR3FGTXlmdmdvdwAAQdQUCxRJYXl4MHUtWFQzdmtzVk0tcElWAABB6hQLCiUzRmtleSUzRAAAQfYUCwhVTktOT1dOAABBgBULCFVOS05PV04AAEGKFQsIVklTSUJMRQAAQZQVCwhWSVNJQkxFAABBnhULB0hJRERFTgAAQaYVCwdISURERU4AAEGuFQsKZmlyZWJhc2VfAABBuhULCGdvb2dsZV8AAEHEFQsEZ2FfAABByhULGCU1RSU1QmEtekEtWiU1RCU1Q3cqJTI0AABB5BULDnNlcnZpY2VXb3JrZXIAAEH0FQsIdmlzaWJsZQAAQf4VCwdoaWRkZW4AAEGGFgsIc2xvdy0yZwAAQZAWCwMyZwAAQZQWCwMzZwAAQZgWCwM0ZwAAQZwWCw5ubyUyMGFwcCUyMGlkAABBrBYLEm5vJTIwcHJvamVjdCUyMGlkAABBwBYLD25vJTIwYXBpJTIwa2V5AABB0BYLBjAuMC4xAABB2BYLHEZJUkVCQVNFX0lOU1RBTExBVElPTlNfQVVUSAAAQfYWC0FDb3VsZCUyMG5vdCUyMGZldGNoJTIwY29uZmlnJTJDJTIwd2lsbCUyMHVzZSUyMGRlZmF1bHQlMjBjb25maWdzAABBuBcLGVJDJTIwcmVzcG9uc2UlMjBub3QlMjBvawAAQdIXCwV0cnVlAABB2BcLCWNvbXBsZXRlAABB4hcLCWNvbXBsZXRlAABB7BcLEXJlYWR5c3RhdGVjaGFuZ2UAAEH+FwsRcmVhZHlzdGF0ZWNoYW5nZQAAQZAYCylDYWxsJTIwdG8lMjBGaXJlYmFzZSUyMGJhY2tlbmQlMjBmYWlsZWQuAABBuhgLFFJFVFJZX1JFUVVFU1RfTEFURVIAAEHQGAsTaW52YWxpZCUyMGNjJTIwbG9nAABB5BgLBCUzRgAAQeoYCwQlM0YAAEHwGAsCXwAAQfQYCxB0cmFjZSUyMHN0YXJ0ZWQAAEGGGQsQdHJhY2UlMjBzdG9wcGVkAABBmBkLIG5vbnBvc2l0aXZlJTIwdHJhY2UlMjBzdGFydFRpbWUAAEG6GQsfbm9ucG9zaXRpdmUlMjB0cmFjZSUyMGR1cmF0aW9uAABB2hkLIWludmFsaWQlMjBjdXN0b20lMjBtZXRyaWMlMjBuYW1lAABB/BkLG2ludmFsaWQlMjBhdHRyaWJ1dGUlMjBuYW1lAABBmBoLHGludmFsaWQlMjBhdHRyaWJ1dGUlMjB2YWx1ZQAAQbYaCw9kb21JbnRlcmFjdGl2ZQAAQcYaCxlkb21Db250ZW50TG9hZGVkRXZlbnRFbmQAAEHgGgsNbG9hZEV2ZW50RW5kAABB7hoLDGZpcnN0LXBhaW50AABB/BoLF2ZpcnN0LWNvbnRlbnRmdWwtcGFpbnQAAEGUGwsEJTNGAABBmhsLCXJlc291cmNlAABBpBsLCXJlc291cmNlAABBrhsLC25hdmlnYXRpb24AAEG6GwsGcGFpbnQAAEHCGwsIbWVhc3VyZQAAQcwbCwhtZWFzdXJlAABB1hsLV0ZpcmViYXNlJTIwUGVyZm9ybWFuY2UlMjBjYW5ub3QlMjBzdGFydCUyMGlmJTIwdGhlJTIwYnJvd3NlciUyMGRvZXMlMjBub3QlMjBzdXBwb3J0JTIwAABBrhwLRiUyMkZldGNoJTIyJTIwYW5kJTIwJTIyUHJvbWlzZSUyMiUyQyUyMG9yJTIwY29va2llcyUyMGFyZSUyMGRpc2FibGVkLgAAQfYcCw4lNUJERUZBVUxUJTVEAABBhh0LDHBlcmZvcm1hbmNlAABBlB0LDHBlcmZvcm1hbmNlAABBoh0LFmFscmVhZHklMjBpbml0aWFsaXplZAAAQbodCwRhcHAAAEHAHQsXaW5zdGFsbGF0aW9ucy1pbnRlcm5hbAAAQdgdCxNGQiUyMG5vdCUyMGRlZmF1bHQAAEHsHQsKdW5kZWZpbmVkAABB+B0LDG5vJTIwd2luZG93AABBhh4LDHBlcmZvcm1hbmNlAABBlB4LB1BVQkxJQwAAQZweCwhlc20yMDE3AABBph4LBWJ0b2EA'].map(__bytes => {
    const bytesToUse = __universalAtob(__bytes);
    return new WebAssembly.Instance(new WebAssembly.Module(bytesToUse));
});
const lS = (wI, pos, iWC) => {
    let __str = '';
    if (!Array.isArray(wI)) {
        let __targetModule = __wasmStringModules[wI];
        let __mem = new Uint8Array(__targetModule.exports.memory.buffer);
        const __stringKey = `data${ pos }`;
        let __start = __targetModule.exports[__stringKey] - 1;
        let __str = '';
        let i = __start;
        let __c = __mem[i++];
        while (!(parseInt(__c) & 128) && __mem[i]) {
            __str += __c;
            __c = String.fromCharCode(__mem[i++]);
        }
        __str += __c;
        __str = decodeURIComponent(__str.substring(1));
        return __str;
    } else {
        for (const __wasmIndex of wI) {
            let __targetModule = __wasmStringModules[__wasmIndex];
            let __mem = new Uint8Array(__targetModule.exports.memory.buffer);
            const __stringKey = `data${ pos }`;
            let __start = __targetModule.exports[__stringKey] - 1;
            let i = __start;
            let __c = __mem[i++];
            while (!(parseInt(__c) & 128) && __mem[i]) {
                __str += __c;
                __c = String.fromCharCode(__mem[i++]);
            }
            __str += __c;
        }
        __str = decodeURIComponent(__str.substring(1));
        return __str;
    }
};
import {
    registerVersion,
    _registerComponent,
    _getProvider,
    getApp
} from 'https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js';
function isIndexedDBAvailable() {
    return typeof indexedDB === lS(0, 0);
}
function validateIndexedDBOpenable() {
    return new Promise((resolve, reject) => {
        try {
            let preExist = true;
            const DB_CHECK_NAME = lS(0, 1);
            const request = self.indexedDB.open(DB_CHECK_NAME);
            request.onsuccess = () => {
                (() => {
                    const __callInstance152 = new WebAssembly.Instance(__callWasmModule, {
                        env: {
                            impFunc: () => {
                                request.result.close();
                            }
                        }
                    });
                    const __exports = __callInstance152.exports;
                    return __exports.data();
                })();
                (() => {
                    const __ifInstance0 = new WebAssembly.Instance(__ifWasmModule, {
                        env: {
                            impFunc1: () => {
                                {
                                    (() => {
                                        const __callInstance151 = new WebAssembly.Instance(__callWasmModule, {
                                            env: {
                                                impFunc: () => {
                                                    self.indexedDB.deleteDatabase(DB_CHECK_NAME);
                                                }
                                            }
                                        });
                                        const __exports = __callInstance151.exports;
                                        return __exports.data();
                                    })();
                                }
                            },
                            impFunc2: () => {
                            }
                        }
                    });
                    const __exports = __ifInstance0.exports;
                    return __exports.data(!preExist ? 1 : 0);
                })();
                (() => {
                    const __callInstance150 = new WebAssembly.Instance(__callWasmModule, {
                        env: {
                            impFunc: () => {
                                resolve(true);
                            }
                        }
                    });
                    const __exports = __callInstance150.exports;
                    return __exports.data();
                })();
            };
            request.onupgradeneeded = () => {
                preExist = false;
            };
            request.onerror = () => {
                var _a;
                (() => {
                    const __callInstance149 = new WebAssembly.Instance(__callWasmModule, {
                        env: {
                            impFunc: () => {
                                reject(((_a = request.error) === null || _a === void 0 ? void 0 : _a.message) || lS(0, 2));
                            }
                        }
                    });
                    const __exports = __callInstance149.exports;
                    return __exports.data();
                })();
            };
        } catch (error) {
            (() => {
                const __callInstance148 = new WebAssembly.Instance(__callWasmModule, {
                    env: {
                        impFunc: () => {
                            reject(error);
                        }
                    }
                });
                const __exports = __callInstance148.exports;
                return __exports.data();
            })();
        }
    });
}
function areCookiesEnabled() {
    if (typeof navigator === lS(0, 3) || !navigator.cookieEnabled) {
        return false;
    }
    return true;
}
const ERROR_NAME = lS(0, 4);
class FirebaseError extends Error {
    constructor(code, message, customData) {
        (() => {
            const __callInstance147 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        super(message);
                    }
                }
            });
            const __exports = __callInstance147.exports;
            return __exports.data();
        })();
        this.code = code;
        this.customData = customData;
        this.name = ERROR_NAME;
        (() => {
            const __callInstance146 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        Object.setPrototypeOf(this, FirebaseError.prototype);
                    }
                }
            });
            const __exports = __callInstance146.exports;
            return __exports.data();
        })();
        (() => {
            const __ifInstance1 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            (() => {
                                const __callInstance145 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            Error.captureStackTrace(this, ErrorFactory.prototype.create);
                                        }
                                    }
                                });
                                const __exports = __callInstance145.exports;
                                return __exports.data();
                            })();
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance1.exports;
            return __exports.data(Error.captureStackTrace ? 1 : 0);
        })();
    }
}
class ErrorFactory {
    constructor(service, serviceName, errors) {
        this.service = service;
        this.serviceName = serviceName;
        this.errors = errors;
    }
    create(code, ...data) {
        const customData = data[0] || {};
        const fullCode = `${ this.service }/${ code }`;
        const template = this.errors[code];
        const message = template ? replaceTemplate(template, customData) : lS(0, 5);
        const fullMessage = `${ this.serviceName }: ${ message } (${ fullCode }).`;
        const error = new FirebaseError(fullCode, fullMessage, customData);
        return error;
    }
}
function replaceTemplate(template, data) {
    return template.replace(PATTERN, (_, key) => {
        const value = data[key];
        return value != null ? String(value) : `<${ key }?>`;
    });
}
const PATTERN = /\{\$([^}]+)}/g;
function deepEqual(a, b) {
    if (a === b) {
        return true;
    }
    const aKeys = Object.keys(a);
    const bKeys = Object.keys(b);
    for (const k of aKeys) {
        if (!bKeys.includes(k)) {
            return false;
        }
        const aProp = a[k];
        const bProp = b[k];
        if (isObject(aProp) && isObject(bProp)) {
            if (!deepEqual(aProp, bProp)) {
                return false;
            }
        } else if (aProp !== bProp) {
            return false;
        }
    }
    for (const k of bKeys) {
        if (!aKeys.includes(k)) {
            return false;
        }
    }
    return true;
}
function isObject(thing) {
    return thing !== null && typeof thing === lS(0, 6);
}
function getModularInstance(service) {
    if (service && service._delegate) {
        return service._delegate;
    } else {
        return service;
    }
}
var LogLevel;
(() => {
    const __callInstance144 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                (function (LogLevel) {
                    LogLevel[LogLevel[lS(0, 7)] = 0] = lS(0, 8);
                    LogLevel[LogLevel[lS(0, 9)] = 1] = lS(0, 10);
                    LogLevel[LogLevel[lS(0, 11)] = 2] = lS(0, 12);
                    LogLevel[LogLevel[lS(0, 13)] = 3] = lS(0, 14);
                    LogLevel[LogLevel[lS(0, 15)] = 4] = lS(0, 16);
                    LogLevel[LogLevel[lS(0, 17)] = 5] = lS(0, 18);
                }(LogLevel || (LogLevel = {})));
            }
        }
    });
    const __exports = __callInstance144.exports;
    return __exports.data();
})();
const levelStringToEnum = {
    'debug': LogLevel.DEBUG,
    'verbose': LogLevel.VERBOSE,
    'info': LogLevel.INFO,
    'warn': LogLevel.WARN,
    'error': LogLevel.ERROR,
    'silent': LogLevel.SILENT
};
const defaultLogLevel = LogLevel.INFO;
const ConsoleMethod = {
    [LogLevel.DEBUG]: 'log',
    [LogLevel.VERBOSE]: 'log',
    [LogLevel.INFO]: 'info',
    [LogLevel.WARN]: 'warn',
    [LogLevel.ERROR]: 'error'
};
const defaultLogHandler = (instance, logType, ...args) => {
    if (logType < instance.logLevel) {
        return;
    }
    const now = new Date().toISOString();
    const method = ConsoleMethod[logType];
    if (method) {
        (() => {
            const __callInstance143 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        console[method](`[${ now }]  ${ instance.name }:`, ...args);
                    }
                }
            });
            const __exports = __callInstance143.exports;
            return __exports.data();
        })();
    } else {
        throw new Error(`Attempted to log a message with an invalid logType (value: ${ logType })`);
    }
};
class Logger {
    constructor(name) {
        this.name = name;
        this._logLevel = defaultLogLevel;
        this._logHandler = defaultLogHandler;
        this._userLogHandler = null;
    }
    get logLevel() {
        return this._logLevel;
    }
    set logLevel(val) {
        if (!(val in LogLevel)) {
            throw new TypeError(`Invalid value "${ val }" assigned to \`logLevel\``);
        }
        this._logLevel = val;
    }
    setLogLevel(val) {
        this._logLevel = typeof val === lS(0, 19) ? levelStringToEnum[val] : val;
    }
    get logHandler() {
        return this._logHandler;
    }
    set logHandler(val) {
        if (typeof val !== lS(0, 20)) {
            throw new TypeError(lS(0, 21));
        }
        this._logHandler = val;
    }
    get userLogHandler() {
        return this._userLogHandler;
    }
    set userLogHandler(val) {
        this._userLogHandler = val;
    }
    debug(...args) {
        this._userLogHandler && this._userLogHandler(this, LogLevel.DEBUG, ...args);
        (() => {
            const __callInstance142 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this._logHandler(this, LogLevel.DEBUG, ...args);
                    }
                }
            });
            const __exports = __callInstance142.exports;
            return __exports.data();
        })();
    }
    log(...args) {
        this._userLogHandler && this._userLogHandler(this, LogLevel.VERBOSE, ...args);
        (() => {
            const __callInstance141 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this._logHandler(this, LogLevel.VERBOSE, ...args);
                    }
                }
            });
            const __exports = __callInstance141.exports;
            return __exports.data();
        })();
    }
    info(...args) {
        this._userLogHandler && this._userLogHandler(this, LogLevel.INFO, ...args);
        (() => {
            const __callInstance140 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this._logHandler(this, LogLevel.INFO, ...args);
                    }
                }
            });
            const __exports = __callInstance140.exports;
            return __exports.data();
        })();
    }
    warn(...args) {
        this._userLogHandler && this._userLogHandler(this, LogLevel.WARN, ...args);
        (() => {
            const __callInstance139 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this._logHandler(this, LogLevel.WARN, ...args);
                    }
                }
            });
            const __exports = __callInstance139.exports;
            return __exports.data();
        })();
    }
    error(...args) {
        this._userLogHandler && this._userLogHandler(this, LogLevel.ERROR, ...args);
        (() => {
            const __callInstance138 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this._logHandler(this, LogLevel.ERROR, ...args);
                    }
                }
            });
            const __exports = __callInstance138.exports;
            return __exports.data();
        })();
    }
}
class Component {
    constructor(name, instanceFactory, type) {
        this.name = name;
        this.instanceFactory = instanceFactory;
        this.type = type;
        this.multipleInstances = false;
        this.serviceProps = {};
        this.instantiationMode = lS(0, 22);
        this.onInstanceCreated = null;
    }
    setInstantiationMode(mode) {
        this.instantiationMode = mode;
        return this;
    }
    setMultipleInstances(multipleInstances) {
        this.multipleInstances = multipleInstances;
        return this;
    }
    setServiceProps(props) {
        this.serviceProps = props;
        return this;
    }
    setInstanceCreatedCallback(callback) {
        this.onInstanceCreated = callback;
        return this;
    }
}
function toArray(arr) {
    return Array.prototype.slice.call(arr);
}
function promisifyRequest(request) {
    return new Promise(function (resolve, reject) {
        request.onsuccess = function () {
            (() => {
                const __callInstance137 = new WebAssembly.Instance(__callWasmModule, {
                    env: {
                        impFunc: () => {
                            resolve(request.result);
                        }
                    }
                });
                const __exports = __callInstance137.exports;
                return __exports.data();
            })();
        };
        request.onerror = function () {
            (() => {
                const __callInstance136 = new WebAssembly.Instance(__callWasmModule, {
                    env: {
                        impFunc: () => {
                            reject(request.error);
                        }
                    }
                });
                const __exports = __callInstance136.exports;
                return __exports.data();
            })();
        };
    });
}
function promisifyRequestCall(obj, method, args) {
    var request;
    var p = new Promise(function (resolve, reject) {
        request = obj[method].apply(obj, args);
        (() => {
            const __callInstance135 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        promisifyRequest(request).then(resolve, reject);
                    }
                }
            });
            const __exports = __callInstance135.exports;
            return __exports.data();
        })();
    });
    p.request = request;
    return p;
}
function promisifyCursorRequestCall(obj, method, args) {
    var p = promisifyRequestCall(obj, method, args);
    return p.then(function (value) {
        if (!value)
            return;
        return new Cursor(value, p.request);
    });
}
function proxyProperties(ProxyClass, targetProp, properties) {
    (() => {
        const __callInstance134 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    properties.forEach(function (prop) {
                        (() => {
                            const __callInstance133 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        Object.defineProperty(ProxyClass.prototype, prop, {
                                            get: function () {
                                                return this[targetProp][prop];
                                            },
                                            set: function (val) {
                                                this[targetProp][prop] = val;
                                            }
                                        });
                                    }
                                }
                            });
                            const __exports = __callInstance133.exports;
                            return __exports.data();
                        })();
                    });
                }
            }
        });
        const __exports = __callInstance134.exports;
        return __exports.data();
    })();
}
function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {
    (() => {
        const __callInstance132 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    properties.forEach(function (prop) {
                        if (!(prop in Constructor.prototype))
                            return;
                        ProxyClass.prototype[prop] = function () {
                            return promisifyRequestCall(this[targetProp], prop, arguments);
                        };
                    });
                }
            }
        });
        const __exports = __callInstance132.exports;
        return __exports.data();
    })();
}
function proxyMethods(ProxyClass, targetProp, Constructor, properties) {
    (() => {
        const __callInstance131 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    properties.forEach(function (prop) {
                        if (!(prop in Constructor.prototype))
                            return;
                        ProxyClass.prototype[prop] = function () {
                            return this[targetProp][prop].apply(this[targetProp], arguments);
                        };
                    });
                }
            }
        });
        const __exports = __callInstance131.exports;
        return __exports.data();
    })();
}
function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {
    (() => {
        const __callInstance130 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    properties.forEach(function (prop) {
                        if (!(prop in Constructor.prototype))
                            return;
                        ProxyClass.prototype[prop] = function () {
                            return promisifyCursorRequestCall(this[targetProp], prop, arguments);
                        };
                    });
                }
            }
        });
        const __exports = __callInstance130.exports;
        return __exports.data();
    })();
}
function Index(index) {
    this._index = index;
}
(() => {
    const __callInstance129 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                proxyProperties(Index, lS(0, 23), [
                    lS(0, 24),
                    lS(0, 25),
                    lS(0, 26),
                    lS(0, 27)
                ]);
            }
        }
    });
    const __exports = __callInstance129.exports;
    return __exports.data();
})();
(() => {
    const __callInstance128 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                proxyRequestMethods(Index, lS(0, 28), IDBIndex, [
                    lS(0, 29),
                    lS(0, 30),
                    lS(0, 31),
                    lS(0, 32),
                    lS(0, 33)
                ]);
            }
        }
    });
    const __exports = __callInstance128.exports;
    return __exports.data();
})();
(() => {
    const __callInstance127 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                proxyCursorRequestMethods(Index, lS(0, 34), IDBIndex, [
                    lS(0, 35),
                    lS(0, 36)
                ]);
            }
        }
    });
    const __exports = __callInstance127.exports;
    return __exports.data();
})();
function Cursor(cursor, request) {
    this._cursor = cursor;
    this._request = request;
}
(() => {
    const __callInstance126 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                proxyProperties(Cursor, lS(0, 37), [
                    lS(0, 38),
                    lS(0, 39),
                    lS(0, 40),
                    lS(0, 41)
                ]);
            }
        }
    });
    const __exports = __callInstance126.exports;
    return __exports.data();
})();
(() => {
    const __callInstance125 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                proxyRequestMethods(Cursor, lS(0, 42), IDBCursor, [
                    lS(0, 43),
                    lS(0, 44)
                ]);
            }
        }
    });
    const __exports = __callInstance125.exports;
    return __exports.data();
})();
(() => {
    const __callInstance124 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                [
                    lS(0, 45),
                    lS(0, 46),
                    lS(0, 47)
                ].forEach(function (methodName) {
                    if (!(methodName in IDBCursor.prototype))
                        return;
                    Cursor.prototype[methodName] = function () {
                        var cursor = this;
                        var args = arguments;
                        return Promise.resolve().then(function () {
                            (() => {
                                const __callInstance123 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            cursor._cursor[methodName].apply(cursor._cursor, args);
                                        }
                                    }
                                });
                                const __exports = __callInstance123.exports;
                                return __exports.data();
                            })();
                            return promisifyRequest(cursor._request).then(function (value) {
                                if (!value)
                                    return;
                                return new Cursor(value, cursor._request);
                            });
                        });
                    };
                });
            }
        }
    });
    const __exports = __callInstance124.exports;
    return __exports.data();
})();
function ObjectStore(store) {
    this._store = store;
}
ObjectStore.prototype.createIndex = function () {
    return new Index(this._store.createIndex.apply(this._store, arguments));
};
ObjectStore.prototype.index = function () {
    return new Index(this._store.index.apply(this._store, arguments));
};
(() => {
    const __callInstance122 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                proxyProperties(ObjectStore, lS(0, 48), [
                    lS(0, 49),
                    lS(0, 50),
                    lS(0, 51),
                    lS(0, 52)
                ]);
            }
        }
    });
    const __exports = __callInstance122.exports;
    return __exports.data();
})();
(() => {
    const __callInstance121 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                proxyRequestMethods(ObjectStore, lS(0, 53), IDBObjectStore, [
                    lS(0, 54),
                    lS(0, 55),
                    lS(0, 56),
                    lS(0, 57),
                    lS(0, 58),
                    lS(0, 59),
                    lS(0, 60),
                    lS(0, 61),
                    lS(0, 62)
                ]);
            }
        }
    });
    const __exports = __callInstance121.exports;
    return __exports.data();
})();
(() => {
    const __callInstance120 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                proxyCursorRequestMethods(ObjectStore, lS(0, 63), IDBObjectStore, [
                    lS(0, 64),
                    lS(0, 65)
                ]);
            }
        }
    });
    const __exports = __callInstance120.exports;
    return __exports.data();
})();
(() => {
    const __callInstance119 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                proxyMethods(ObjectStore, lS(0, 66), IDBObjectStore, [lS(0, 67)]);
            }
        }
    });
    const __exports = __callInstance119.exports;
    return __exports.data();
})();
function Transaction(idbTransaction) {
    this._tx = idbTransaction;
    this.complete = new Promise(function (resolve, reject) {
        idbTransaction.oncomplete = function () {
            (() => {
                const __callInstance118 = new WebAssembly.Instance(__callWasmModule, {
                    env: {
                        impFunc: () => {
                            resolve();
                        }
                    }
                });
                const __exports = __callInstance118.exports;
                return __exports.data();
            })();
        };
        idbTransaction.onerror = function () {
            (() => {
                const __callInstance117 = new WebAssembly.Instance(__callWasmModule, {
                    env: {
                        impFunc: () => {
                            reject(idbTransaction.error);
                        }
                    }
                });
                const __exports = __callInstance117.exports;
                return __exports.data();
            })();
        };
        idbTransaction.onabort = function () {
            (() => {
                const __callInstance116 = new WebAssembly.Instance(__callWasmModule, {
                    env: {
                        impFunc: () => {
                            reject(idbTransaction.error);
                        }
                    }
                });
                const __exports = __callInstance116.exports;
                return __exports.data();
            })();
        };
    });
}
Transaction.prototype.objectStore = function () {
    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));
};
(() => {
    const __callInstance115 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                proxyProperties(Transaction, lS(0, 68), [
                    lS(0, 69),
                    lS(0, 70)
                ]);
            }
        }
    });
    const __exports = __callInstance115.exports;
    return __exports.data();
})();
(() => {
    const __callInstance114 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                proxyMethods(Transaction, lS(0, 71), IDBTransaction, [lS(0, 72)]);
            }
        }
    });
    const __exports = __callInstance114.exports;
    return __exports.data();
})();
function UpgradeDB(db, oldVersion, transaction) {
    this._db = db;
    this.oldVersion = oldVersion;
    this.transaction = new Transaction(transaction);
}
UpgradeDB.prototype.createObjectStore = function () {
    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));
};
(() => {
    const __callInstance113 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                proxyProperties(UpgradeDB, lS(0, 73), [
                    lS(0, 74),
                    lS(0, 75),
                    lS(0, 76)
                ]);
            }
        }
    });
    const __exports = __callInstance113.exports;
    return __exports.data();
})();
(() => {
    const __callInstance112 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                proxyMethods(UpgradeDB, lS(0, 77), IDBDatabase, [
                    lS(0, 78),
                    lS(0, 79)
                ]);
            }
        }
    });
    const __exports = __callInstance112.exports;
    return __exports.data();
})();
function DB(db) {
    this._db = db;
}
DB.prototype.transaction = function () {
    return new Transaction(this._db.transaction.apply(this._db, arguments));
};
(() => {
    const __callInstance111 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                proxyProperties(DB, lS(0, 80), [
                    lS(0, 81),
                    lS(0, 82),
                    lS(0, 83)
                ]);
            }
        }
    });
    const __exports = __callInstance111.exports;
    return __exports.data();
})();
(() => {
    const __callInstance110 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                proxyMethods(DB, lS(0, 84), IDBDatabase, [lS(0, 85)]);
            }
        }
    });
    const __exports = __callInstance110.exports;
    return __exports.data();
})();
(() => {
    const __callInstance109 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                [
                    lS(0, 86),
                    lS(0, 87)
                ].forEach(function (funcName) {
                    (() => {
                        const __callInstance108 = new WebAssembly.Instance(__callWasmModule, {
                            env: {
                                impFunc: () => {
                                    [
                                        ObjectStore,
                                        Index
                                    ].forEach(function (Constructor) {
                                        if (!(funcName in Constructor.prototype))
                                            return;
                                        Constructor.prototype[funcName.replace(lS(0, 88), lS(0, 89))] = function () {
                                            var args = toArray(arguments);
                                            var callback = args[args.length - 1];
                                            var nativeObject = this._store || this._index;
                                            var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));
                                            request.onsuccess = function () {
                                                (() => {
                                                    const __callInstance107 = new WebAssembly.Instance(__callWasmModule, {
                                                        env: {
                                                            impFunc: () => {
                                                                callback(request.result);
                                                            }
                                                        }
                                                    });
                                                    const __exports = __callInstance107.exports;
                                                    return __exports.data();
                                                })();
                                            };
                                        };
                                    });
                                }
                            }
                        });
                        const __exports = __callInstance108.exports;
                        return __exports.data();
                    })();
                });
            }
        }
    });
    const __exports = __callInstance109.exports;
    return __exports.data();
})();
(() => {
    const __callInstance106 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                [
                    Index,
                    ObjectStore
                ].forEach(function (Constructor) {
                    if (Constructor.prototype.getAll)
                        return;
                    Constructor.prototype.getAll = function (query, count) {
                        var instance = this;
                        var items = [];
                        return new Promise(function (resolve) {
                            (() => {
                                const __callInstance105 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            instance.iterateCursor(query, function (cursor) {
                                                if (!cursor) {
                                                    (() => {
                                                        const __callInstance104 = new WebAssembly.Instance(__callWasmModule, {
                                                            env: {
                                                                impFunc: () => {
                                                                    resolve(items);
                                                                }
                                                            }
                                                        });
                                                        const __exports = __callInstance104.exports;
                                                        return __exports.data();
                                                    })();
                                                    return;
                                                }
                                                (() => {
                                                    const __callInstance103 = new WebAssembly.Instance(__callWasmModule, {
                                                        env: {
                                                            impFunc: () => {
                                                                items.push(cursor.value);
                                                            }
                                                        }
                                                    });
                                                    const __exports = __callInstance103.exports;
                                                    return __exports.data();
                                                })();
                                                if (count !== undefined && items.length == count) {
                                                    (() => {
                                                        const __callInstance102 = new WebAssembly.Instance(__callWasmModule, {
                                                            env: {
                                                                impFunc: () => {
                                                                    resolve(items);
                                                                }
                                                            }
                                                        });
                                                        const __exports = __callInstance102.exports;
                                                        return __exports.data();
                                                    })();
                                                    return;
                                                }
                                                (() => {
                                                    const __callInstance101 = new WebAssembly.Instance(__callWasmModule, {
                                                        env: {
                                                            impFunc: () => {
                                                                cursor.continue();
                                                            }
                                                        }
                                                    });
                                                    const __exports = __callInstance101.exports;
                                                    return __exports.data();
                                                })();
                                            });
                                        }
                                    }
                                });
                                const __exports = __callInstance105.exports;
                                return __exports.data();
                            })();
                        });
                    };
                });
            }
        }
    });
    const __exports = __callInstance106.exports;
    return __exports.data();
})();
function openDb(name, version, upgradeCallback) {
    var p = promisifyRequestCall(indexedDB, lS(0, 90), [
        name,
        version
    ]);
    var request = p.request;
    (() => {
        const __ifInstance2 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        request.onupgradeneeded = function (event) {
                            (() => {
                                const __ifInstance3 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                (() => {
                                                    const __callInstance100 = new WebAssembly.Instance(__callWasmModule, {
                                                        env: {
                                                            impFunc: () => {
                                                                upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));
                                                            }
                                                        }
                                                    });
                                                    const __exports = __callInstance100.exports;
                                                    return __exports.data();
                                                })();
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance3.exports;
                                return __exports.data(upgradeCallback ? 1 : 0);
                            })();
                        };
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance2.exports;
        return __exports.data(request ? 1 : 0);
    })();
    return p.then(function (db) {
        return new DB(db);
    });
}
const name$1 = lS(0, 91);
const version$1 = lS(0, 92);
const PENDING_TIMEOUT_MS = 10000;
const PACKAGE_VERSION = `w:${ version$1 }`;
const INTERNAL_AUTH_VERSION = lS(0, 93);
const INSTALLATIONS_API_URL = lS(0, 94);
const TOKEN_EXPIRATION_BUFFER = 60 * 60 * 1000;
const SERVICE$1 = lS(0, 95);
const SERVICE_NAME$1 = lS(0, 96);
const ERROR_DESCRIPTION_MAP$1 = {
    ['missing-app-config-values']: 'Missing App configuration value: "{$valueName}"',
    ['not-registered']: 'Firebase Installation is not registered.',
    ['installation-not-found']: 'Firebase Installation not found.',
    ['request-failed']: '{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',
    ['app-offline']: 'Could not process request. Application offline.',
    ['delete-pending-registration']: 'Can\'t delete installation while there is a pending registration request.'
};
const ERROR_FACTORY$1 = new ErrorFactory(SERVICE$1, SERVICE_NAME$1, ERROR_DESCRIPTION_MAP$1);
function isServerError(error) {
    return error instanceof FirebaseError && error.code.includes(lS(0, 97));
}
function getInstallationsEndpoint({projectId}) {
    return `${ INSTALLATIONS_API_URL }/projects/${ projectId }/installations`;
}
function extractAuthTokenInfoFromResponse(response) {
    return {
        token: response.token,
        requestStatus: 2,
        expiresIn: getExpiresInFromResponseExpiresIn(response.expiresIn),
        creationTime: Date.now()
    };
}
async function getErrorFromResponse(requestName, response) {
    const responseJson = await response.json();
    const errorData = responseJson.error;
    return ERROR_FACTORY$1.create(lS(0, 98), {
        requestName,
        serverCode: errorData.code,
        serverMessage: errorData.message,
        serverStatus: errorData.status
    });
}
function getHeaders({apiKey}) {
    return new Headers({
        'Content-Type': 'application/json',
        Accept: 'application/json',
        'x-goog-api-key': apiKey
    });
}
function getHeadersWithAuth(appConfig, {refreshToken}) {
    const headers = getHeaders(appConfig);
    (() => {
        const __callInstance99 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    headers.append(lS(0, 99), getAuthorizationHeader(refreshToken));
                }
            }
        });
        const __exports = __callInstance99.exports;
        return __exports.data();
    })();
    return headers;
}
async function retryIfServerError(fn) {
    const result = await fn();
    if (result.status >= 500 && result.status < 600) {
        return fn();
    }
    return result;
}
function getExpiresInFromResponseExpiresIn(responseExpiresIn) {
    return Number(responseExpiresIn.replace(lS(0, 100), lS(0, 101)));
}
function getAuthorizationHeader(refreshToken) {
    return `${ INTERNAL_AUTH_VERSION } ${ refreshToken }`;
}
async function createInstallationRequest(appConfig, {fid}) {
    const endpoint = getInstallationsEndpoint(appConfig);
    const headers = getHeaders(appConfig);
    const body = {
        fid,
        authVersion: INTERNAL_AUTH_VERSION,
        appId: appConfig.appId,
        sdkVersion: PACKAGE_VERSION
    };
    const request = {
        method: 'POST',
        headers,
        body: JSON.stringify(body)
    };
    const response = await retryIfServerError(() => fetch(endpoint, request));
    if (response.ok) {
        const responseValue = await response.json();
        const registeredInstallationEntry = {
            fid: responseValue.fid || fid,
            registrationStatus: 2,
            refreshToken: responseValue.refreshToken,
            authToken: extractAuthTokenInfoFromResponse(responseValue.authToken)
        };
        return registeredInstallationEntry;
    } else {
        throw await getErrorFromResponse(lS(0, 102), response);
    }
}
function sleep(ms) {
    return new Promise(resolve => {
        (() => {
            const __callInstance98 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        setTimeout(resolve, ms);
                    }
                }
            });
            const __exports = __callInstance98.exports;
            return __exports.data();
        })();
    });
}
function bufferToBase64UrlSafe(array) {
    const b64 = window[lS(0, 231, true)](String.fromCharCode(...array));
    return b64.replace(/\+/g, lS(0, 103)).replace(/\//g, lS(0, 104));
}
const VALID_FID_PATTERN = /^[cdef][\w-]{21}$/;
const INVALID_FID = lS(0, 105);
function generateFid() {
    try {
        const fidByteArray = new Uint8Array(17);
        const crypto = self.crypto || self.msCrypto;
        (() => {
            const __callInstance97 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        crypto.getRandomValues(fidByteArray);
                    }
                }
            });
            const __exports = __callInstance97.exports;
            return __exports.data();
        })();
        fidByteArray[0] = 112 + fidByteArray[0] % 16;
        const fid = encode(fidByteArray);
        return VALID_FID_PATTERN.test(fid) ? fid : INVALID_FID;
    } catch (_a) {
        return INVALID_FID;
    }
}
function encode(fidByteArray) {
    const b64String = bufferToBase64UrlSafe(fidByteArray);
    return b64String.substr(0, 22);
}
function getKey(appConfig) {
    return `${ appConfig.appName }!${ appConfig.appId }`;
}
const fidChangeCallbacks = new Map();
function fidChanged(appConfig, fid) {
    const key = getKey(appConfig);
    (() => {
        const __callInstance96 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    callFidChangeCallbacks(key, fid);
                }
            }
        });
        const __exports = __callInstance96.exports;
        return __exports.data();
    })();
    (() => {
        const __callInstance95 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    broadcastFidChange(key, fid);
                }
            }
        });
        const __exports = __callInstance95.exports;
        return __exports.data();
    })();
}
function callFidChangeCallbacks(key, fid) {
    const callbacks = fidChangeCallbacks.get(key);
    if (!callbacks) {
        return;
    }
    for (const callback of callbacks) {
        (() => {
            const __callInstance94 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        callback(fid);
                    }
                }
            });
            const __exports = __callInstance94.exports;
            return __exports.data();
        })();
    }
}
function broadcastFidChange(key, fid) {
    const channel = getBroadcastChannel();
    (() => {
        const __ifInstance4 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        (() => {
                            const __callInstance93 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        channel.postMessage({
                                            key,
                                            fid
                                        });
                                    }
                                }
                            });
                            const __exports = __callInstance93.exports;
                            return __exports.data();
                        })();
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance4.exports;
        return __exports.data(channel ? 1 : 0);
    })();
    (() => {
        const __callInstance92 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    closeBroadcastChannel();
                }
            }
        });
        const __exports = __callInstance92.exports;
        return __exports.data();
    })();
}
let broadcastChannel = null;
function getBroadcastChannel() {
    (() => {
        const __ifInstance5 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        broadcastChannel = new BroadcastChannel(lS(0, 107));
                        broadcastChannel.onmessage = e => {
                            (() => {
                                const __callInstance91 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            callFidChangeCallbacks(e.data.key, e.data.fid);
                                        }
                                    }
                                });
                                const __exports = __callInstance91.exports;
                                return __exports.data();
                            })();
                        };
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance5.exports;
        return __exports.data(!broadcastChannel && lS(0, 106) in self ? 1 : 0);
    })();
    return broadcastChannel;
}
function closeBroadcastChannel() {
    (() => {
        const __ifInstance6 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        (() => {
                            const __callInstance90 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        broadcastChannel.close();
                                    }
                                }
                            });
                            const __exports = __callInstance90.exports;
                            return __exports.data();
                        })();
                        broadcastChannel = null;
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance6.exports;
        return __exports.data(fidChangeCallbacks.size === 0 && broadcastChannel ? 1 : 0);
    })();
}
const DATABASE_NAME = lS(0, 108);
const DATABASE_VERSION = 1;
const OBJECT_STORE_NAME = lS(0, 109);
let dbPromise = null;
function getDbPromise() {
    (() => {
        const __ifInstance7 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        dbPromise = openDb(DATABASE_NAME, DATABASE_VERSION, upgradeDB => {
                            switch (upgradeDB.oldVersion) {
                            case 0:
                                (() => {
                                    const __callInstance89 = new WebAssembly.Instance(__callWasmModule, {
                                        env: {
                                            impFunc: () => {
                                                upgradeDB.createObjectStore(OBJECT_STORE_NAME);
                                            }
                                        }
                                    });
                                    const __exports = __callInstance89.exports;
                                    return __exports.data();
                                })();
                            }
                        });
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance7.exports;
        return __exports.data(!dbPromise ? 1 : 0);
    })();
    return dbPromise;
}
async function set(appConfig, value) {
    const key = getKey(appConfig);
    const db = await getDbPromise();
    const tx = db.transaction(OBJECT_STORE_NAME, lS(0, 110));
    const objectStore = tx.objectStore(OBJECT_STORE_NAME);
    const oldValue = await objectStore.get(key);
    await objectStore.put(value, key);
    await tx.complete;
    (() => {
        const __ifInstance8 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        (() => {
                            const __callInstance88 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        fidChanged(appConfig, value.fid);
                                    }
                                }
                            });
                            const __exports = __callInstance88.exports;
                            return __exports.data();
                        })();
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance8.exports;
        return __exports.data(!oldValue || oldValue.fid !== value.fid ? 1 : 0);
    })();
    return value;
}
async function remove(appConfig) {
    const key = getKey(appConfig);
    const db = await getDbPromise();
    const tx = db.transaction(OBJECT_STORE_NAME, lS(0, 111));
    await tx.objectStore(OBJECT_STORE_NAME).delete(key);
    await tx.complete;
}
async function update(appConfig, updateFn) {
    const key = getKey(appConfig);
    const db = await getDbPromise();
    const tx = db.transaction(OBJECT_STORE_NAME, lS(0, 112));
    const store = tx.objectStore(OBJECT_STORE_NAME);
    const oldValue = await store.get(key);
    const newValue = updateFn(oldValue);
    (() => {
        const __ifInstance9 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        await store.delete(key);
                    }
                },
                impFunc2: () => {
                    {
                        await store.put(newValue, key);
                    }
                }
            }
        });
        const __exports = __ifInstance9.exports;
        return __exports.data(newValue === undefined ? 1 : 0);
    })();
    await tx.complete;
    (() => {
        const __ifInstance10 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        (() => {
                            const __callInstance87 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        fidChanged(appConfig, newValue.fid);
                                    }
                                }
                            });
                            const __exports = __callInstance87.exports;
                            return __exports.data();
                        })();
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance10.exports;
        return __exports.data(newValue && (!oldValue || oldValue.fid !== newValue.fid) ? 1 : 0);
    })();
    return newValue;
}
async function getInstallationEntry(appConfig) {
    let registrationPromise;
    const installationEntry = await update(appConfig, oldEntry => {
        const installationEntry = updateOrCreateInstallationEntry(oldEntry);
        const entryWithPromise = triggerRegistrationIfNecessary(appConfig, installationEntry);
        registrationPromise = entryWithPromise.registrationPromise;
        return entryWithPromise.installationEntry;
    });
    if (installationEntry.fid === INVALID_FID) {
        return { installationEntry: await registrationPromise };
    }
    return {
        installationEntry,
        registrationPromise
    };
}
function updateOrCreateInstallationEntry(oldEntry) {
    const entry = oldEntry || {
        fid: generateFid(),
        registrationStatus: 0
    };
    return clearTimedOutRequest(entry);
}
function triggerRegistrationIfNecessary(appConfig, installationEntry) {
    if (installationEntry.registrationStatus === 0) {
        if (!navigator.onLine) {
            const registrationPromiseWithError = Promise.reject(ERROR_FACTORY$1.create(lS(0, 113)));
            return {
                installationEntry,
                registrationPromise: registrationPromiseWithError
            };
        }
        const inProgressEntry = {
            fid: installationEntry.fid,
            registrationStatus: 1,
            registrationTime: Date.now()
        };
        const registrationPromise = registerInstallation(appConfig, inProgressEntry);
        return {
            installationEntry: inProgressEntry,
            registrationPromise
        };
    } else if (installationEntry.registrationStatus === 1) {
        return {
            installationEntry,
            registrationPromise: waitUntilFidRegistration(appConfig)
        };
    } else {
        return { installationEntry };
    }
}
async function registerInstallation(appConfig, installationEntry) {
    try {
        const registeredInstallationEntry = await createInstallationRequest(appConfig, installationEntry);
        return set(appConfig, registeredInstallationEntry);
    } catch (e) {
        (() => {
            const __ifInstance11 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            await remove(appConfig);
                        }
                    },
                    impFunc2: () => {
                        {
                            await set(appConfig, {
                                fid: installationEntry.fid,
                                registrationStatus: 0
                            });
                        }
                    }
                }
            });
            const __exports = __ifInstance11.exports;
            return __exports.data(isServerError(e) && e.customData.serverCode === 409 ? 1 : 0);
        })();
        throw e;
    }
}
async function waitUntilFidRegistration(appConfig) {
    let entry = await updateInstallationRequest(appConfig);
    (() => {
        const __forInstance1 = new WebAssembly.Instance(__forWasmModule, {
            env: {
                test: () => {
                    return entry.registrationStatus === 1 ? 1 : 0;
                },
                update: () => {
                },
                body: () => {
                    {
                        await sleep(100);
                        entry = await updateInstallationRequest(appConfig);
                    }
                }
            }
        });
        const __exports = __forInstance1.exports;
        return __exports.data();
    })();
    if (entry.registrationStatus === 0) {
        const {installationEntry, registrationPromise} = await getInstallationEntry(appConfig);
        if (registrationPromise) {
            return registrationPromise;
        } else {
            return installationEntry;
        }
    }
    return entry;
}
function updateInstallationRequest(appConfig) {
    return update(appConfig, oldEntry => {
        if (!oldEntry) {
            throw ERROR_FACTORY$1.create(lS(0, 114));
        }
        return clearTimedOutRequest(oldEntry);
    });
}
function clearTimedOutRequest(entry) {
    if (hasInstallationRequestTimedOut(entry)) {
        return {
            fid: entry.fid,
            registrationStatus: 0
        };
    }
    return entry;
}
function hasInstallationRequestTimedOut(installationEntry) {
    return installationEntry.registrationStatus === 1 && installationEntry.registrationTime + PENDING_TIMEOUT_MS < Date.now();
}
async function generateAuthTokenRequest({appConfig, platformLoggerProvider}, installationEntry) {
    const endpoint = getGenerateAuthTokenEndpoint(appConfig, installationEntry);
    const headers = getHeadersWithAuth(appConfig, installationEntry);
    const platformLogger = platformLoggerProvider.getImmediate({ optional: true });
    (() => {
        const __ifInstance12 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        (() => {
                            const __callInstance86 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        headers.append(lS(0, 115), platformLogger.getPlatformInfoString());
                                    }
                                }
                            });
                            const __exports = __callInstance86.exports;
                            return __exports.data();
                        })();
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance12.exports;
        return __exports.data(platformLogger ? 1 : 0);
    })();
    const body = { installation: { sdkVersion: PACKAGE_VERSION } };
    const request = {
        method: 'POST',
        headers,
        body: JSON.stringify(body)
    };
    const response = await retryIfServerError(() => fetch(endpoint, request));
    if (response.ok) {
        const responseValue = await response.json();
        const completedAuthToken = extractAuthTokenInfoFromResponse(responseValue);
        return completedAuthToken;
    } else {
        throw await getErrorFromResponse(lS(0, 116), response);
    }
}
function getGenerateAuthTokenEndpoint(appConfig, {fid}) {
    return `${ getInstallationsEndpoint(appConfig) }/${ fid }/authTokens:generate`;
}
async function refreshAuthToken(installations, forceRefresh = false) {
    let tokenPromise;
    const entry = await update(installations.appConfig, oldEntry => {
        if (!isEntryRegistered(oldEntry)) {
            throw ERROR_FACTORY$1.create(lS(0, 117));
        }
        const oldAuthToken = oldEntry.authToken;
        if (!forceRefresh && isAuthTokenValid(oldAuthToken)) {
            return oldEntry;
        } else if (oldAuthToken.requestStatus === 1) {
            tokenPromise = waitUntilAuthTokenRequest(installations, forceRefresh);
            return oldEntry;
        } else {
            if (!navigator.onLine) {
                throw ERROR_FACTORY$1.create(lS(0, 118));
            }
            const inProgressEntry = makeAuthTokenRequestInProgressEntry(oldEntry);
            tokenPromise = fetchAuthTokenFromServer(installations, inProgressEntry);
            return inProgressEntry;
        }
    });
    const authToken = tokenPromise ? await tokenPromise : entry.authToken;
    return authToken;
}
async function waitUntilAuthTokenRequest(installations, forceRefresh) {
    let entry = await updateAuthTokenRequest(installations.appConfig);
    (() => {
        const __forInstance2 = new WebAssembly.Instance(__forWasmModule, {
            env: {
                test: () => {
                    return entry.authToken.requestStatus === 1 ? 1 : 0;
                },
                update: () => {
                },
                body: () => {
                    {
                        await sleep(100);
                        entry = await updateAuthTokenRequest(installations.appConfig);
                    }
                }
            }
        });
        const __exports = __forInstance2.exports;
        return __exports.data();
    })();
    const authToken = entry.authToken;
    if (authToken.requestStatus === 0) {
        return refreshAuthToken(installations, forceRefresh);
    } else {
        return authToken;
    }
}
function updateAuthTokenRequest(appConfig) {
    return update(appConfig, oldEntry => {
        if (!isEntryRegistered(oldEntry)) {
            throw ERROR_FACTORY$1.create(lS(0, 119));
        }
        const oldAuthToken = oldEntry.authToken;
        if (hasAuthTokenRequestTimedOut(oldAuthToken)) {
            return Object.assign(Object.assign({}, oldEntry), { authToken: { requestStatus: 0 } });
        }
        return oldEntry;
    });
}
async function fetchAuthTokenFromServer(installations, installationEntry) {
    try {
        const authToken = await generateAuthTokenRequest(installations, installationEntry);
        const updatedInstallationEntry = Object.assign(Object.assign({}, installationEntry), { authToken });
        await set(installations.appConfig, updatedInstallationEntry);
        return authToken;
    } catch (e) {
        (() => {
            const __ifInstance13 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            await remove(installations.appConfig);
                        }
                    },
                    impFunc2: () => {
                        {
                            const updatedInstallationEntry = Object.assign(Object.assign({}, installationEntry), { authToken: { requestStatus: 0 } });
                            await set(installations.appConfig, updatedInstallationEntry);
                        }
                    }
                }
            });
            const __exports = __ifInstance13.exports;
            return __exports.data(isServerError(e) && (e.customData.serverCode === 401 || e.customData.serverCode === 404) ? 1 : 0);
        })();
        throw e;
    }
}
function isEntryRegistered(installationEntry) {
    return installationEntry !== undefined && installationEntry.registrationStatus === 2;
}
function isAuthTokenValid(authToken) {
    return authToken.requestStatus === 2 && !isAuthTokenExpired(authToken);
}
function isAuthTokenExpired(authToken) {
    const now = Date.now();
    return now < authToken.creationTime || authToken.creationTime + authToken.expiresIn < now + TOKEN_EXPIRATION_BUFFER;
}
function makeAuthTokenRequestInProgressEntry(oldEntry) {
    const inProgressAuthToken = {
        requestStatus: 1,
        requestTime: Date.now()
    };
    return Object.assign(Object.assign({}, oldEntry), { authToken: inProgressAuthToken });
}
function hasAuthTokenRequestTimedOut(authToken) {
    return authToken.requestStatus === 1 && authToken.requestTime + PENDING_TIMEOUT_MS < Date.now();
}
async function getId(installations) {
    const installationsImpl = installations;
    const {installationEntry, registrationPromise} = await getInstallationEntry(installationsImpl.appConfig);
    (() => {
        const __ifInstance14 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        (() => {
                            const __callInstance85 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        registrationPromise.catch(console.error);
                                    }
                                }
                            });
                            const __exports = __callInstance85.exports;
                            return __exports.data();
                        })();
                    }
                },
                impFunc2: () => {
                    {
                        (() => {
                            const __callInstance84 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        refreshAuthToken(installationsImpl).catch(console.error);
                                    }
                                }
                            });
                            const __exports = __callInstance84.exports;
                            return __exports.data();
                        })();
                    }
                }
            }
        });
        const __exports = __ifInstance14.exports;
        return __exports.data(registrationPromise ? 1 : 0);
    })();
    return installationEntry.fid;
}
async function getToken(installations, forceRefresh = false) {
    const installationsImpl = installations;
    await completeInstallationRegistration(installationsImpl.appConfig);
    const authToken = await refreshAuthToken(installationsImpl, forceRefresh);
    return authToken.token;
}
async function completeInstallationRegistration(appConfig) {
    const {registrationPromise} = await getInstallationEntry(appConfig);
    (() => {
        const __ifInstance15 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        await registrationPromise;
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance15.exports;
        return __exports.data(registrationPromise ? 1 : 0);
    })();
}
function extractAppConfig(app) {
    if (!app || !app.options) {
        throw getMissingValueError(lS(0, 120));
    }
    if (!app.name) {
        throw getMissingValueError(lS(0, 121));
    }
    const configKeys = [
        lS(0, 122),
        lS(0, 123),
        lS(0, 124)
    ];
    for (const keyName of configKeys) {
        if (!app.options[keyName]) {
            throw getMissingValueError(keyName);
        }
    }
    return {
        appName: app.name,
        projectId: app.options.projectId,
        apiKey: app.options.apiKey,
        appId: app.options.appId
    };
}
function getMissingValueError(valueName) {
    return ERROR_FACTORY$1.create(lS(0, 125), { valueName });
}
const INSTALLATIONS_NAME = lS(0, 126);
const INSTALLATIONS_NAME_INTERNAL = lS(0, 127);
const publicFactory = container => {
    const app = container.getProvider(lS(0, 128)).getImmediate();
    const appConfig = extractAppConfig(app);
    const platformLoggerProvider = _getProvider(app, lS(0, 129));
    const installationsImpl = {
        app,
        appConfig,
        platformLoggerProvider,
        _delete: () => Promise.resolve()
    };
    return installationsImpl;
};
const internalFactory = container => {
    const app = container.getProvider(lS(0, 130)).getImmediate();
    const installations = _getProvider(app, INSTALLATIONS_NAME).getImmediate();
    const installationsInternal = {
        getId: () => getId(installations),
        getToken: forceRefresh => getToken(installations, forceRefresh)
    };
    return installationsInternal;
};
function registerInstallations() {
    (() => {
        const __callInstance83 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    _registerComponent(new Component(INSTALLATIONS_NAME, publicFactory, lS(0, 131)));
                }
            }
        });
        const __exports = __callInstance83.exports;
        return __exports.data();
    })();
    (() => {
        const __callInstance82 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    _registerComponent(new Component(INSTALLATIONS_NAME_INTERNAL, internalFactory, lS(0, 132)));
                }
            }
        });
        const __exports = __callInstance82.exports;
        return __exports.data();
    })();
}
(() => {
    const __callInstance81 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                registerInstallations();
            }
        }
    });
    const __exports = __callInstance81.exports;
    return __exports.data();
})();
(() => {
    const __callInstance80 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                registerVersion(name$1, version$1);
            }
        }
    });
    const __exports = __callInstance80.exports;
    return __exports.data();
})();
(() => {
    const __callInstance79 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                registerVersion(name$1, version$1, lS(0, 133));
            }
        }
    });
    const __exports = __callInstance79.exports;
    return __exports.data();
})();
const name = lS(0, 134);
const version = lS(0, 135);
const SDK_VERSION = version;
const TRACE_START_MARK_PREFIX = lS(0, 136);
const TRACE_STOP_MARK_PREFIX = lS(0, 137);
const TRACE_MEASURE_PREFIX = lS(0, 138);
const OOB_TRACE_PAGE_LOAD_PREFIX = lS(0, 139);
const FIRST_PAINT_COUNTER_NAME = lS(0, 140);
const FIRST_CONTENTFUL_PAINT_COUNTER_NAME = lS(0, 141);
const FIRST_INPUT_DELAY_COUNTER_NAME = lS(0, 142);
const CONFIG_LOCAL_STORAGE_KEY = lS(0, 143);
const CONFIG_EXPIRY_LOCAL_STORAGE_KEY = lS(0, 144);
const SERVICE = lS(0, 145);
const SERVICE_NAME = lS(0, 146);
const ERROR_DESCRIPTION_MAP = {
    ['trace started']: 'Trace {$traceName} was started before.',
    ['trace stopped']: 'Trace {$traceName} is not running.',
    ['nonpositive trace startTime']: 'Trace {$traceName} startTime should be positive.',
    ['nonpositive trace duration']: 'Trace {$traceName} duration should be positive.',
    ['no window']: 'Window is not available.',
    ['no app id']: 'App id is not available.',
    ['no project id']: 'Project id is not available.',
    ['no api key']: 'Api key is not available.',
    ['invalid cc log']: 'Attempted to queue invalid cc event',
    ['FB not default']: 'Performance can only start when Firebase app instance is the default one.',
    ['RC response not ok']: 'RC response is not ok',
    ['invalid attribute name']: 'Attribute name {$attributeName} is invalid.',
    ['invalid attribute value']: 'Attribute value {$attributeValue} is invalid.',
    ['invalid custom metric name']: 'Custom metric name {$customMetricName} is invalid',
    ['invalid String merger input']: 'Input for String merger is invalid, contact support team to resolve.',
    ['already initialized']: lS(0, 147) + lS(0, 148) + lS(0, 149) + lS(0, 150)
};
const ERROR_FACTORY = new ErrorFactory(SERVICE, SERVICE_NAME, ERROR_DESCRIPTION_MAP);
const consoleLogger = new Logger(SERVICE_NAME);
consoleLogger.logLevel = LogLevel.INFO;
let apiInstance;
let windowInstance;
class Api {
    constructor(window) {
        this.window = window;
        if (!window) {
            throw ERROR_FACTORY.create(lS(0, 151));
        }
        this.performance = window.performance;
        this.PerformanceObserver = window.PerformanceObserver;
        this.windowLocation = window.location;
        this.navigator = window.navigator;
        this.document = window.document;
        (() => {
            const __ifInstance16 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            this.localStorage = window.localStorage;
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance16.exports;
            return __exports.data(this.navigator && this.navigator.cookieEnabled ? 1 : 0);
        })();
        (() => {
            const __ifInstance17 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            this.onFirstInputDelay = window.perfMetrics.onFirstInputDelay;
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance17.exports;
            return __exports.data(window.perfMetrics && window.perfMetrics.onFirstInputDelay ? 1 : 0);
        })();
    }
    getUrl() {
        return this.windowLocation.href.split(lS(0, 152))[0];
    }
    mark(name) {
        if (!this.performance || !this.performance.mark) {
            return;
        }
        (() => {
            const __callInstance78 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this.performance.mark(name);
                    }
                }
            });
            const __exports = __callInstance78.exports;
            return __exports.data();
        })();
    }
    measure(measureName, mark1, mark2) {
        if (!this.performance || !this.performance.measure) {
            return;
        }
        (() => {
            const __callInstance77 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this.performance.measure(measureName, mark1, mark2);
                    }
                }
            });
            const __exports = __callInstance77.exports;
            return __exports.data();
        })();
    }
    getEntriesByType(type) {
        if (!this.performance || !this.performance.getEntriesByType) {
            return [];
        }
        return this.performance.getEntriesByType(type);
    }
    getEntriesByName(name) {
        if (!this.performance || !this.performance.getEntriesByName) {
            return [];
        }
        return this.performance.getEntriesByName(name);
    }
    getTimeOrigin() {
        return this.performance && (this.performance.timeOrigin || this.performance.timing.navigationStart);
    }
    requiredApisAvailable() {
        if (!fetch || !Promise || !areCookiesEnabled()) {
            (() => {
                const __callInstance76 = new WebAssembly.Instance(__callWasmModule, {
                    env: {
                        impFunc: () => {
                            consoleLogger.info(lS(0, 153));
                        }
                    }
                });
                const __exports = __callInstance76.exports;
                return __exports.data();
            })();
            return false;
        }
        if (!isIndexedDBAvailable()) {
            (() => {
                const __callInstance75 = new WebAssembly.Instance(__callWasmModule, {
                    env: {
                        impFunc: () => {
                            consoleLogger.info(lS(0, 154));
                        }
                    }
                });
                const __exports = __callInstance75.exports;
                return __exports.data();
            })();
            return false;
        }
        return true;
    }
    setupObserver(entryType, callback) {
        if (!this.PerformanceObserver) {
            return;
        }
        const observer = new this.PerformanceObserver(list => {
            for (const entry of list.getEntries()) {
                (() => {
                    const __callInstance74 = new WebAssembly.Instance(__callWasmModule, {
                        env: {
                            impFunc: () => {
                                callback(entry);
                            }
                        }
                    });
                    const __exports = __callInstance74.exports;
                    return __exports.data();
                })();
            }
        });
        (() => {
            const __callInstance73 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        observer.observe({ entryTypes: [entryType] });
                    }
                }
            });
            const __exports = __callInstance73.exports;
            return __exports.data();
        })();
    }
    static getInstance() {
        (() => {
            const __ifInstance18 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            apiInstance = new Api(windowInstance);
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance18.exports;
            return __exports.data(apiInstance === undefined ? 1 : 0);
        })();
        return apiInstance;
    }
}
function setupApi(window) {
    windowInstance = window;
}
let iid;
function getIidPromise(installationsService) {
    const iidPromise = installationsService.getId();
    (() => {
        const __callInstance72 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    iidPromise.then(iidVal => {
                        iid = iidVal;
                    });
                }
            }
        });
        const __exports = __callInstance72.exports;
        return __exports.data();
    })();
    return iidPromise;
}
function getIid() {
    return iid;
}
function getAuthTokenPromise(installationsService) {
    const authTokenPromise = installationsService.getToken();
    (() => {
        const __callInstance71 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    authTokenPromise.then(authTokenVal => {
                    });
                }
            }
        });
        const __exports = __callInstance71.exports;
        return __exports.data();
    })();
    return authTokenPromise;
}
function mergeStrings(part1, part2) {
    const sizeDiff = part1.length - part2.length;
    if (sizeDiff < 0 || sizeDiff > 1) {
        throw ERROR_FACTORY.create(lS(0, 155));
    }
    const resultArray = [];
    (() => {
        let i = 0;
        const __forInstance0 = new WebAssembly.Instance(__forWasmModule, {
            env: {
                test: () => {
                    return i < part1.length ? 1 : 0;
                },
                update: () => {
                    i++;
                },
                body: () => {
                    {
                        (() => {
                            const __callInstance70 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        resultArray.push(part1.charAt(i));
                                    }
                                }
                            });
                            const __exports = __callInstance70.exports;
                            return __exports.data();
                        })();
                        (() => {
                            const __ifInstance19 = new WebAssembly.Instance(__ifWasmModule, {
                                env: {
                                    impFunc1: () => {
                                        {
                                            (() => {
                                                const __callInstance69 = new WebAssembly.Instance(__callWasmModule, {
                                                    env: {
                                                        impFunc: () => {
                                                            resultArray.push(part2.charAt(i));
                                                        }
                                                    }
                                                });
                                                const __exports = __callInstance69.exports;
                                                return __exports.data();
                                            })();
                                        }
                                    },
                                    impFunc2: () => {
                                    }
                                }
                            });
                            const __exports = __ifInstance19.exports;
                            return __exports.data(part2.length > i ? 1 : 0);
                        })();
                    }
                }
            }
        });
        const __exports = __forInstance0.exports;
        return __exports.data();
    })();
    return resultArray.join(lS(0, 156));
}
let settingsServiceInstance;
class SettingsService {
    constructor() {
        this.instrumentationEnabled = true;
        this.dataCollectionEnabled = true;
        this.loggingEnabled = false;
        this.tracesSamplingRate = 1;
        this.networkRequestsSamplingRate = 1;
        this.logEndPointUrl = lS(0, 157);
        this.flTransportEndpointUrl = mergeStrings(lS(0, 158), lS(0, 159));
        this.transportKey = mergeStrings(lS(0, 160), lS(0, 161));
        this.logSource = 462;
        this.logTraceAfterSampling = false;
        this.logNetworkAfterSampling = false;
        this.configTimeToLive = 12;
    }
    getFlTransportFullUrl() {
        return this.flTransportEndpointUrl.concat(lS(0, 162), this.transportKey);
    }
    static getInstance() {
        (() => {
            const __ifInstance20 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            settingsServiceInstance = new SettingsService();
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance20.exports;
            return __exports.data(settingsServiceInstance === undefined ? 1 : 0);
        })();
        return settingsServiceInstance;
    }
}
var VisibilityState;
(() => {
    const __callInstance68 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                (function (VisibilityState) {
                    VisibilityState[VisibilityState[lS(0, 163)] = 0] = lS(0, 164);
                    VisibilityState[VisibilityState[lS(0, 165)] = 1] = lS(0, 166);
                    VisibilityState[VisibilityState[lS(0, 167)] = 2] = lS(0, 168);
                }(VisibilityState || (VisibilityState = {})));
            }
        }
    });
    const __exports = __callInstance68.exports;
    return __exports.data();
})();
const RESERVED_ATTRIBUTE_PREFIXES = [
    lS(0, 169),
    lS(0, 170),
    lS(0, 171)
];
const ATTRIBUTE_FORMAT_REGEX = new RegExp(lS(0, 172));
const MAX_ATTRIBUTE_NAME_LENGTH = 40;
const MAX_ATTRIBUTE_VALUE_LENGTH = 100;
function getServiceWorkerStatus() {
    const navigator = Api.getInstance().navigator;
    if (lS(0, 173) in navigator) {
        if (navigator.serviceWorker.controller) {
            return 2;
        } else {
            return 3;
        }
    } else {
        return 1;
    }
}
function getVisibilityState() {
    const document = Api.getInstance().document;
    const visibilityState = document.visibilityState;
    switch (visibilityState) {
    case lS(0, 174):
        return VisibilityState.VISIBLE;
    case lS(0, 175):
        return VisibilityState.HIDDEN;
    default:
        return VisibilityState.UNKNOWN;
    }
}
function getEffectiveConnectionType() {
    const navigator = Api.getInstance().navigator;
    const navigatorConnection = navigator.connection;
    const effectiveType = navigatorConnection && navigatorConnection.effectiveType;
    switch (effectiveType) {
    case lS(0, 176):
        return 1;
    case lS(0, 177):
        return 2;
    case lS(0, 178):
        return 3;
    case lS(0, 179):
        return 4;
    default:
        return 0;
    }
}
function isValidCustomAttributeName(name) {
    if (name.length === 0 || name.length > MAX_ATTRIBUTE_NAME_LENGTH) {
        return false;
    }
    const matchesReservedPrefix = RESERVED_ATTRIBUTE_PREFIXES.some(prefix => name.startsWith(prefix));
    return !matchesReservedPrefix && !!name.match(ATTRIBUTE_FORMAT_REGEX);
}
function isValidCustomAttributeValue(value) {
    return value.length !== 0 && value.length <= MAX_ATTRIBUTE_VALUE_LENGTH;
}
function getAppId(firebaseApp) {
    var _a;
    const appId = (_a = firebaseApp.options) === null || _a === void 0 ? void 0 : _a.appId;
    if (!appId) {
        throw ERROR_FACTORY.create(lS(0, 180));
    }
    return appId;
}
function getProjectId(firebaseApp) {
    var _a;
    const projectId = (_a = firebaseApp.options) === null || _a === void 0 ? void 0 : _a.projectId;
    if (!projectId) {
        throw ERROR_FACTORY.create(lS(0, 181));
    }
    return projectId;
}
function getApiKey(firebaseApp) {
    var _a;
    const apiKey = (_a = firebaseApp.options) === null || _a === void 0 ? void 0 : _a.apiKey;
    if (!apiKey) {
        throw ERROR_FACTORY.create(lS(0, 182));
    }
    return apiKey;
}
const REMOTE_CONFIG_SDK_VERSION = lS(0, 183);
const DEFAULT_CONFIGS = { loggingEnabled: true };
const FIS_AUTH_PREFIX = lS(0, 184);
function getConfig(performanceController, iid) {
    const config = getStoredConfig();
    if (config) {
        (() => {
            const __callInstance67 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        processConfig(config);
                    }
                }
            });
            const __exports = __callInstance67.exports;
            return __exports.data();
        })();
        return Promise.resolve();
    }
    return getRemoteConfig(performanceController, iid).then(processConfig).then(config => storeConfig(config), () => {
    });
}
function getStoredConfig() {
    const localStorage = Api.getInstance().localStorage;
    if (!localStorage) {
        return;
    }
    const expiryString = localStorage.getItem(CONFIG_EXPIRY_LOCAL_STORAGE_KEY);
    if (!expiryString || !configValid(expiryString)) {
        return;
    }
    const configStringified = localStorage.getItem(CONFIG_LOCAL_STORAGE_KEY);
    if (!configStringified) {
        return;
    }
    try {
        const configResponse = JSON.parse(configStringified);
        return configResponse;
    } catch (_a) {
        return;
    }
}
function storeConfig(config) {
    const localStorage = Api.getInstance().localStorage;
    if (!config || !localStorage) {
        return;
    }
    (() => {
        const __callInstance66 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    localStorage.setItem(CONFIG_LOCAL_STORAGE_KEY, JSON.stringify(config));
                }
            }
        });
        const __exports = __callInstance66.exports;
        return __exports.data();
    })();
    (() => {
        const __callInstance65 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    localStorage.setItem(CONFIG_EXPIRY_LOCAL_STORAGE_KEY, String(Date.now() + SettingsService.getInstance().configTimeToLive * 60 * 60 * 1000));
                }
            }
        });
        const __exports = __callInstance65.exports;
        return __exports.data();
    })();
}
const COULD_NOT_GET_CONFIG_MSG = lS(0, 185);
function getRemoteConfig(performanceController, iid) {
    return getAuthTokenPromise(performanceController.installations).then(authToken => {
        const projectId = getProjectId(performanceController.app);
        const apiKey = getApiKey(performanceController.app);
        const configEndPoint = `https://firebaseremoteconfig.googleapis.com/v1/projects/${ projectId }/namespaces/fireperf:fetch?key=${ apiKey }`;
        const request = new Request(configEndPoint, {
            method: 'POST',
            headers: { Authorization: `${ FIS_AUTH_PREFIX } ${ authToken }` },
            body: JSON.stringify({
                app_instance_id: iid,
                app_instance_id_token: authToken,
                app_id: getAppId(performanceController.app),
                app_version: SDK_VERSION,
                sdk_version: REMOTE_CONFIG_SDK_VERSION
            })
        });
        return fetch(request).then(response => {
            if (response.ok) {
                return response.json();
            }
            throw ERROR_FACTORY.create(lS(0, 186));
        });
    }).catch(() => {
        (() => {
            const __callInstance64 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        consoleLogger.info(COULD_NOT_GET_CONFIG_MSG);
                    }
                }
            });
            const __exports = __callInstance64.exports;
            return __exports.data();
        })();
        return undefined;
    });
}
function processConfig(config) {
    if (!config) {
        return config;
    }
    const settingsServiceInstance = SettingsService.getInstance();
    const entries = config.entries || {};
    (() => {
        const __ifInstance21 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        settingsServiceInstance.loggingEnabled = String(entries.fpr_enabled) === lS(0, 187);
                    }
                },
                impFunc2: () => {
                    {
                        settingsServiceInstance.loggingEnabled = DEFAULT_CONFIGS.loggingEnabled;
                    }
                }
            }
        });
        const __exports = __ifInstance21.exports;
        return __exports.data(entries.fpr_enabled !== undefined ? 1 : 0);
    })();
    (() => {
        const __ifInstance22 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        settingsServiceInstance.logSource = Number(entries.fpr_log_source);
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance22.exports;
        return __exports.data(entries.fpr_log_source ? 1 : 0);
    })();
    (() => {
        const __ifInstance23 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        settingsServiceInstance.logEndPointUrl = entries.fpr_log_endpoint_url;
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance23.exports;
        return __exports.data(entries.fpr_log_endpoint_url ? 1 : 0);
    })();
    (() => {
        const __ifInstance24 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        settingsServiceInstance.transportKey = entries.fpr_log_transport_key;
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance24.exports;
        return __exports.data(entries.fpr_log_transport_key ? 1 : 0);
    })();
    (() => {
        const __ifInstance25 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        settingsServiceInstance.networkRequestsSamplingRate = Number(entries.fpr_vc_network_request_sampling_rate);
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance25.exports;
        return __exports.data(entries.fpr_vc_network_request_sampling_rate !== undefined ? 1 : 0);
    })();
    (() => {
        const __ifInstance26 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        settingsServiceInstance.tracesSamplingRate = Number(entries.fpr_vc_trace_sampling_rate);
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance26.exports;
        return __exports.data(entries.fpr_vc_trace_sampling_rate !== undefined ? 1 : 0);
    })();
    settingsServiceInstance.logTraceAfterSampling = shouldLogAfterSampling(settingsServiceInstance.tracesSamplingRate);
    settingsServiceInstance.logNetworkAfterSampling = shouldLogAfterSampling(settingsServiceInstance.networkRequestsSamplingRate);
    return config;
}
function configValid(expiry) {
    return Number(expiry) > Date.now();
}
function shouldLogAfterSampling(samplingRate) {
    return Math.random() <= samplingRate;
}
let initializationStatus = 1;
let initializationPromise;
function getInitializationPromise(performanceController) {
    initializationStatus = 2;
    initializationPromise = initializationPromise || initializePerf(performanceController);
    return initializationPromise;
}
function isPerfInitialized() {
    return initializationStatus === 3;
}
function initializePerf(performanceController) {
    return getDocumentReadyComplete().then(() => getIidPromise(performanceController.installations)).then(iid => getConfig(performanceController, iid)).then(() => changeInitializationStatus(), () => changeInitializationStatus());
}
function getDocumentReadyComplete() {
    const document = Api.getInstance().document;
    return new Promise(resolve => {
        (() => {
            const __ifInstance27 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            const handler = () => {
                                (() => {
                                    const __ifInstance28 = new WebAssembly.Instance(__ifWasmModule, {
                                        env: {
                                            impFunc1: () => {
                                                {
                                                    (() => {
                                                        const __callInstance63 = new WebAssembly.Instance(__callWasmModule, {
                                                            env: {
                                                                impFunc: () => {
                                                                    document.removeEventListener(lS(0, 190), handler);
                                                                }
                                                            }
                                                        });
                                                        const __exports = __callInstance63.exports;
                                                        return __exports.data();
                                                    })();
                                                    (() => {
                                                        const __callInstance62 = new WebAssembly.Instance(__callWasmModule, {
                                                            env: {
                                                                impFunc: () => {
                                                                    resolve();
                                                                }
                                                            }
                                                        });
                                                        const __exports = __callInstance62.exports;
                                                        return __exports.data();
                                                    })();
                                                }
                                            },
                                            impFunc2: () => {
                                            }
                                        }
                                    });
                                    const __exports = __ifInstance28.exports;
                                    return __exports.data(document.readyState === lS(0, 189) ? 1 : 0);
                                })();
                            };
                            (() => {
                                const __callInstance61 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            document.addEventListener(lS(0, 191), handler);
                                        }
                                    }
                                });
                                const __exports = __callInstance61.exports;
                                return __exports.data();
                            })();
                        }
                    },
                    impFunc2: () => {
                        {
                            (() => {
                                const __callInstance60 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            resolve();
                                        }
                                    }
                                });
                                const __exports = __callInstance60.exports;
                                return __exports.data();
                            })();
                        }
                    }
                }
            });
            const __exports = __ifInstance27.exports;
            return __exports.data(document && document.readyState !== lS(0, 188) ? 1 : 0);
        })();
    });
}
function changeInitializationStatus() {
    initializationStatus = 3;
}
const DEFAULT_SEND_INTERVAL_MS = 10 * 1000;
const INITIAL_SEND_TIME_DELAY_MS = 5.5 * 1000;
const DEFAULT_REMAINING_TRIES = 3;
const MAX_EVENT_COUNT_PER_REQUEST = 1000;
let remainingTries = DEFAULT_REMAINING_TRIES;
let queue = [];
let isTransportSetup = false;
function setupTransportService() {
    (() => {
        const __ifInstance29 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        (() => {
                            const __callInstance59 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        processQueue(INITIAL_SEND_TIME_DELAY_MS);
                                    }
                                }
                            });
                            const __exports = __callInstance59.exports;
                            return __exports.data();
                        })();
                        isTransportSetup = true;
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance29.exports;
        return __exports.data(!isTransportSetup ? 1 : 0);
    })();
}
function processQueue(timeOffset) {
    (() => {
        const __callInstance58 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    setTimeout(() => {
                        if (remainingTries === 0) {
                            return;
                        }
                        if (!queue.length) {
                            return processQueue(DEFAULT_SEND_INTERVAL_MS);
                        }
                        (() => {
                            const __callInstance57 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        dispatchQueueEvents();
                                    }
                                }
                            });
                            const __exports = __callInstance57.exports;
                            return __exports.data();
                        })();
                    }, timeOffset);
                }
            }
        });
        const __exports = __callInstance58.exports;
        return __exports.data();
    })();
}
function dispatchQueueEvents() {
    const staged = queue.splice(0, MAX_EVENT_COUNT_PER_REQUEST);
    const log_event = staged.map(evt => ({
        source_extension_json_proto3: evt.message,
        event_time_ms: String(evt.eventTime)
    }));
    const data = {
        request_time_ms: String(Date.now()),
        client_info: {
            client_type: 1,
            js_client_info: {}
        },
        log_source: SettingsService.getInstance().logSource,
        log_event
    };
    (() => {
        const __callInstance56 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    sendEventsToFl(data, staged).catch(() => {
                        queue = [
                            ...staged,
                            ...queue
                        ];
                        remainingTries--;
                        (() => {
                            const __callInstance55 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        consoleLogger.info(`Tries left: ${ remainingTries }.`);
                                    }
                                }
                            });
                            const __exports = __callInstance55.exports;
                            return __exports.data();
                        })();
                        (() => {
                            const __callInstance54 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        processQueue(DEFAULT_SEND_INTERVAL_MS);
                                    }
                                }
                            });
                            const __exports = __callInstance54.exports;
                            return __exports.data();
                        })();
                    });
                }
            }
        });
        const __exports = __callInstance56.exports;
        return __exports.data();
    })();
}
function sendEventsToFl(data, staged) {
    return postToFlEndpoint(data).then(res => {
        (() => {
            const __ifInstance30 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            (() => {
                                const __callInstance53 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            consoleLogger.info(lS(0, 192));
                                        }
                                    }
                                });
                                const __exports = __callInstance53.exports;
                                return __exports.data();
                            })();
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance30.exports;
            return __exports.data(!res.ok ? 1 : 0);
        })();
        return res.json();
    }).then(res => {
        const transportWait = Number(res.nextRequestWaitMillis);
        let requestOffset = DEFAULT_SEND_INTERVAL_MS;
        (() => {
            const __ifInstance31 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            requestOffset = Math.max(transportWait, requestOffset);
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance31.exports;
            return __exports.data(!isNaN(transportWait) ? 1 : 0);
        })();
        const logResponseDetails = res.logResponseDetails;
        (() => {
            const __ifInstance32 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            queue = [
                                ...staged,
                                ...queue
                            ];
                            (() => {
                                const __callInstance52 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            consoleLogger.info(`Retry transport request later.`);
                                        }
                                    }
                                });
                                const __exports = __callInstance52.exports;
                                return __exports.data();
                            })();
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance32.exports;
            return __exports.data(Array.isArray(logResponseDetails) && logResponseDetails.length > 0 && logResponseDetails[0].responseAction === lS(0, 193) ? 1 : 0);
        })();
        remainingTries = DEFAULT_REMAINING_TRIES;
        (() => {
            const __callInstance51 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        processQueue(requestOffset);
                    }
                }
            });
            const __exports = __callInstance51.exports;
            return __exports.data();
        })();
    });
}
function postToFlEndpoint(data) {
    const flTransportFullUrl = SettingsService.getInstance().getFlTransportFullUrl();
    return fetch(flTransportFullUrl, {
        method: 'POST',
        body: JSON.stringify(data)
    });
}
function addToQueue(evt) {
    if (!evt.eventTime || !evt.message) {
        throw ERROR_FACTORY.create(lS(0, 194));
    }
    queue = [
        ...queue,
        evt
    ];
}
function transportHandler(serializer) {
    return (...args) => {
        const message = serializer(...args);
        (() => {
            const __callInstance50 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        addToQueue({
                            message,
                            eventTime: Date.now()
                        });
                    }
                }
            });
            const __exports = __callInstance50.exports;
            return __exports.data();
        })();
    };
}
let logger;
function sendLog(resource, resourceType) {
    (() => {
        const __ifInstance33 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        logger = transportHandler(serializer);
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance33.exports;
        return __exports.data(!logger ? 1 : 0);
    })();
    (() => {
        const __callInstance49 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    logger(resource, resourceType);
                }
            }
        });
        const __exports = __callInstance49.exports;
        return __exports.data();
    })();
}
function logTrace(trace) {
    const settingsService = SettingsService.getInstance();
    if (!settingsService.instrumentationEnabled && trace.isAuto) {
        return;
    }
    if (!settingsService.dataCollectionEnabled && !trace.isAuto) {
        return;
    }
    if (!Api.getInstance().requiredApisAvailable()) {
        return;
    }
    if (trace.isAuto && getVisibilityState() !== VisibilityState.VISIBLE) {
        return;
    }
    (() => {
        const __ifInstance34 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        (() => {
                            const __callInstance48 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        sendTraceLog(trace);
                                    }
                                }
                            });
                            const __exports = __callInstance48.exports;
                            return __exports.data();
                        })();
                    }
                },
                impFunc2: () => {
                    {
                        (() => {
                            const __callInstance47 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        getInitializationPromise(trace.performanceController).then(() => sendTraceLog(trace), () => sendTraceLog(trace));
                                    }
                                }
                            });
                            const __exports = __callInstance47.exports;
                            return __exports.data();
                        })();
                    }
                }
            }
        });
        const __exports = __ifInstance34.exports;
        return __exports.data(isPerfInitialized() ? 1 : 0);
    })();
}
function sendTraceLog(trace) {
    if (!getIid()) {
        return;
    }
    const settingsService = SettingsService.getInstance();
    if (!settingsService.loggingEnabled || !settingsService.logTraceAfterSampling) {
        return;
    }
    (() => {
        const __callInstance46 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    setTimeout(() => sendLog(trace, 1), 0);
                }
            }
        });
        const __exports = __callInstance46.exports;
        return __exports.data();
    })();
}
function logNetworkRequest(networkRequest) {
    const settingsService = SettingsService.getInstance();
    if (!settingsService.instrumentationEnabled) {
        return;
    }
    const networkRequestUrl = networkRequest.url;
    const logEndpointUrl = settingsService.logEndPointUrl.split(lS(0, 195))[0];
    const flEndpointUrl = settingsService.flTransportEndpointUrl.split(lS(0, 196))[0];
    if (networkRequestUrl === logEndpointUrl || networkRequestUrl === flEndpointUrl) {
        return;
    }
    if (!settingsService.loggingEnabled || !settingsService.logNetworkAfterSampling) {
        return;
    }
    (() => {
        const __callInstance45 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    setTimeout(() => sendLog(networkRequest, 0), 0);
                }
            }
        });
        const __exports = __callInstance45.exports;
        return __exports.data();
    })();
}
function serializer(resource, resourceType) {
    if (resourceType === 0) {
        return serializeNetworkRequest(resource);
    }
    return serializeTrace(resource);
}
function serializeNetworkRequest(networkRequest) {
    const networkRequestMetric = {
        url: networkRequest.url,
        http_method: networkRequest.httpMethod || 0,
        http_response_code: 200,
        response_payload_bytes: networkRequest.responsePayloadBytes,
        client_start_time_us: networkRequest.startTimeUs,
        time_to_response_initiated_us: networkRequest.timeToResponseInitiatedUs,
        time_to_response_completed_us: networkRequest.timeToResponseCompletedUs
    };
    const perfMetric = {
        application_info: getApplicationInfo(networkRequest.performanceController.app),
        network_request_metric: networkRequestMetric
    };
    return JSON.stringify(perfMetric);
}
function serializeTrace(trace) {
    const traceMetric = {
        name: trace.name,
        is_auto: trace.isAuto,
        client_start_time_us: trace.startTimeUs,
        duration_us: trace.durationUs
    };
    (() => {
        const __ifInstance35 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        traceMetric.counters = trace.counters;
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance35.exports;
        return __exports.data(Object.keys(trace.counters).length !== 0 ? 1 : 0);
    })();
    const customAttributes = trace.getAttributes();
    (() => {
        const __ifInstance36 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        traceMetric.custom_attributes = customAttributes;
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance36.exports;
        return __exports.data(Object.keys(customAttributes).length !== 0 ? 1 : 0);
    })();
    const perfMetric = {
        application_info: getApplicationInfo(trace.performanceController.app),
        trace_metric: traceMetric
    };
    return JSON.stringify(perfMetric);
}
function getApplicationInfo(firebaseApp) {
    return {
        google_app_id: getAppId(firebaseApp),
        app_instance_id: getIid(),
        web_app_info: {
            sdk_version: SDK_VERSION,
            page_url: Api.getInstance().getUrl(),
            service_worker_status: getServiceWorkerStatus(),
            visibility_state: getVisibilityState(),
            effective_connection_type: getEffectiveConnectionType()
        },
        application_process_state: 0
    };
}
const MAX_METRIC_NAME_LENGTH = 100;
const RESERVED_AUTO_PREFIX = lS(0, 197);
const oobMetrics = [
    FIRST_PAINT_COUNTER_NAME,
    FIRST_CONTENTFUL_PAINT_COUNTER_NAME,
    FIRST_INPUT_DELAY_COUNTER_NAME
];
function isValidMetricName(name, traceName) {
    if (name.length === 0 || name.length > MAX_METRIC_NAME_LENGTH) {
        return false;
    }
    return traceName && traceName.startsWith(OOB_TRACE_PAGE_LOAD_PREFIX) && oobMetrics.indexOf(name) > -1 || !name.startsWith(RESERVED_AUTO_PREFIX);
}
function convertMetricValueToInteger(providedValue) {
    const valueAsInteger = Math.floor(providedValue);
    (() => {
        const __ifInstance37 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        (() => {
                            const __callInstance44 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        consoleLogger.info(`Metric value should be an Integer, setting the value as : ${ valueAsInteger }.`);
                                    }
                                }
                            });
                            const __exports = __callInstance44.exports;
                            return __exports.data();
                        })();
                    }
                },
                impFunc2: () => {
                }
            }
        });
        const __exports = __ifInstance37.exports;
        return __exports.data(valueAsInteger < providedValue ? 1 : 0);
    })();
    return valueAsInteger;
}
class Trace {
    constructor(performanceController, name, isAuto = false, traceMeasureName) {
        this.performanceController = performanceController;
        this.name = name;
        this.isAuto = isAuto;
        this.state = 1;
        this.customAttributes = {};
        this.counters = {};
        this.api = Api.getInstance();
        this.randomId = Math.floor(Math.random() * 1000000);
        (() => {
            const __ifInstance38 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            this.traceStartMark = `${ TRACE_START_MARK_PREFIX }-${ this.randomId }-${ this.name }`;
                            this.traceStopMark = `${ TRACE_STOP_MARK_PREFIX }-${ this.randomId }-${ this.name }`;
                            this.traceMeasure = traceMeasureName || `${ TRACE_MEASURE_PREFIX }-${ this.randomId }-${ this.name }`;
                            (() => {
                                const __ifInstance39 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                (() => {
                                                    const __callInstance43 = new WebAssembly.Instance(__callWasmModule, {
                                                        env: {
                                                            impFunc: () => {
                                                                this.calculateTraceMetrics();
                                                            }
                                                        }
                                                    });
                                                    const __exports = __callInstance43.exports;
                                                    return __exports.data();
                                                })();
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance39.exports;
                                return __exports.data(traceMeasureName ? 1 : 0);
                            })();
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance38.exports;
            return __exports.data(!this.isAuto ? 1 : 0);
        })();
    }
    start() {
        if (this.state !== 1) {
            throw ERROR_FACTORY.create(lS(0, 198), { traceName: this.name });
        }
        (() => {
            const __callInstance42 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this.api.mark(this.traceStartMark);
                    }
                }
            });
            const __exports = __callInstance42.exports;
            return __exports.data();
        })();
        this.state = 2;
    }
    stop() {
        if (this.state !== 2) {
            throw ERROR_FACTORY.create(lS(0, 199), { traceName: this.name });
        }
        this.state = 3;
        (() => {
            const __callInstance41 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this.api.mark(this.traceStopMark);
                    }
                }
            });
            const __exports = __callInstance41.exports;
            return __exports.data();
        })();
        (() => {
            const __callInstance40 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this.api.measure(this.traceMeasure, this.traceStartMark, this.traceStopMark);
                    }
                }
            });
            const __exports = __callInstance40.exports;
            return __exports.data();
        })();
        (() => {
            const __callInstance39 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        this.calculateTraceMetrics();
                    }
                }
            });
            const __exports = __callInstance39.exports;
            return __exports.data();
        })();
        (() => {
            const __callInstance38 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        logTrace(this);
                    }
                }
            });
            const __exports = __callInstance38.exports;
            return __exports.data();
        })();
    }
    record(startTime, duration, options) {
        if (startTime <= 0) {
            throw ERROR_FACTORY.create(lS(0, 200), { traceName: this.name });
        }
        if (duration <= 0) {
            throw ERROR_FACTORY.create(lS(0, 201), { traceName: this.name });
        }
        this.durationUs = Math.floor(duration * 1000);
        this.startTimeUs = Math.floor(startTime * 1000);
        (() => {
            const __ifInstance40 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            this.customAttributes = Object.assign({}, options.attributes);
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance40.exports;
            return __exports.data(options && options.attributes ? 1 : 0);
        })();
        (() => {
            const __ifInstance41 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            for (const metric of Object.keys(options.metrics)) {
                                (() => {
                                    const __ifInstance42 = new WebAssembly.Instance(__ifWasmModule, {
                                        env: {
                                            impFunc1: () => {
                                                {
                                                    this.counters[metric] = Number(Math.floor(options.metrics[metric]));
                                                }
                                            },
                                            impFunc2: () => {
                                            }
                                        }
                                    });
                                    const __exports = __ifInstance42.exports;
                                    return __exports.data(!isNaN(Number(options.metrics[metric])) ? 1 : 0);
                                })();
                            }
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance41.exports;
            return __exports.data(options && options.metrics ? 1 : 0);
        })();
        (() => {
            const __callInstance37 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        logTrace(this);
                    }
                }
            });
            const __exports = __callInstance37.exports;
            return __exports.data();
        })();
    }
    incrementMetric(counter, numAsInteger = 1) {
        (() => {
            const __ifInstance43 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            (() => {
                                const __callInstance36 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            this.putMetric(counter, numAsInteger);
                                        }
                                    }
                                });
                                const __exports = __callInstance36.exports;
                                return __exports.data();
                            })();
                        }
                    },
                    impFunc2: () => {
                        {
                            (() => {
                                const __callInstance35 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            this.putMetric(counter, this.counters[counter] + numAsInteger);
                                        }
                                    }
                                });
                                const __exports = __callInstance35.exports;
                                return __exports.data();
                            })();
                        }
                    }
                }
            });
            const __exports = __ifInstance43.exports;
            return __exports.data(this.counters[counter] === undefined ? 1 : 0);
        })();
    }
    putMetric(counter, numAsInteger) {
        if (isValidMetricName(counter, this.name)) {
            this.counters[counter] = convertMetricValueToInteger(numAsInteger);
        } else {
            throw ERROR_FACTORY.create(lS(0, 202), { customMetricName: counter });
        }
    }
    getMetric(counter) {
        return this.counters[counter] || 0;
    }
    putAttribute(attr, value) {
        const isValidName = isValidCustomAttributeName(attr);
        const isValidValue = isValidCustomAttributeValue(value);
        if (isValidName && isValidValue) {
            this.customAttributes[attr] = value;
            return;
        }
        if (!isValidName) {
            throw ERROR_FACTORY.create(lS(0, 203), { attributeName: attr });
        }
        if (!isValidValue) {
            throw ERROR_FACTORY.create(lS(0, 204), { attributeValue: value });
        }
    }
    getAttribute(attr) {
        return this.customAttributes[attr];
    }
    removeAttribute(attr) {
        if (this.customAttributes[attr] === undefined) {
            return;
        }
        delete this.customAttributes[attr];
    }
    getAttributes() {
        return Object.assign({}, this.customAttributes);
    }
    setStartTime(startTime) {
        this.startTimeUs = startTime;
    }
    setDuration(duration) {
        this.durationUs = duration;
    }
    calculateTraceMetrics() {
        const perfMeasureEntries = this.api.getEntriesByName(this.traceMeasure);
        const perfMeasureEntry = perfMeasureEntries && perfMeasureEntries[0];
        (() => {
            const __ifInstance44 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            this.durationUs = Math.floor(perfMeasureEntry.duration * 1000);
                            this.startTimeUs = Math.floor((perfMeasureEntry.startTime + this.api.getTimeOrigin()) * 1000);
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance44.exports;
            return __exports.data(perfMeasureEntry ? 1 : 0);
        })();
    }
    static createOobTrace(performanceController, navigationTimings, paintTimings, firstInputDelay) {
        const route = Api.getInstance().getUrl();
        if (!route) {
            return;
        }
        const trace = new Trace(performanceController, OOB_TRACE_PAGE_LOAD_PREFIX + route, true);
        const timeOriginUs = Math.floor(Api.getInstance().getTimeOrigin() * 1000);
        (() => {
            const __callInstance34 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        trace.setStartTime(timeOriginUs);
                    }
                }
            });
            const __exports = __callInstance34.exports;
            return __exports.data();
        })();
        (() => {
            const __ifInstance45 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            (() => {
                                const __callInstance33 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            trace.setDuration(Math.floor(navigationTimings[0].duration * 1000));
                                        }
                                    }
                                });
                                const __exports = __callInstance33.exports;
                                return __exports.data();
                            })();
                            (() => {
                                const __callInstance32 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            trace.putMetric(lS(0, 205), Math.floor(navigationTimings[0].domInteractive * 1000));
                                        }
                                    }
                                });
                                const __exports = __callInstance32.exports;
                                return __exports.data();
                            })();
                            (() => {
                                const __callInstance31 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            trace.putMetric(lS(0, 206), Math.floor(navigationTimings[0].domContentLoadedEventEnd * 1000));
                                        }
                                    }
                                });
                                const __exports = __callInstance31.exports;
                                return __exports.data();
                            })();
                            (() => {
                                const __callInstance30 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            trace.putMetric(lS(0, 207), Math.floor(navigationTimings[0].loadEventEnd * 1000));
                                        }
                                    }
                                });
                                const __exports = __callInstance30.exports;
                                return __exports.data();
                            })();
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance45.exports;
            return __exports.data(navigationTimings && navigationTimings[0] ? 1 : 0);
        })();
        const FIRST_PAINT = lS(0, 208);
        const FIRST_CONTENTFUL_PAINT = lS(0, 209);
        (() => {
            const __ifInstance46 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            const firstPaint = paintTimings.find(paintObject => paintObject.name === FIRST_PAINT);
                            (() => {
                                const __ifInstance47 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                (() => {
                                                    const __callInstance29 = new WebAssembly.Instance(__callWasmModule, {
                                                        env: {
                                                            impFunc: () => {
                                                                trace.putMetric(FIRST_PAINT_COUNTER_NAME, Math.floor(firstPaint.startTime * 1000));
                                                            }
                                                        }
                                                    });
                                                    const __exports = __callInstance29.exports;
                                                    return __exports.data();
                                                })();
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance47.exports;
                                return __exports.data(firstPaint && firstPaint.startTime ? 1 : 0);
                            })();
                            const firstContentfulPaint = paintTimings.find(paintObject => paintObject.name === FIRST_CONTENTFUL_PAINT);
                            (() => {
                                const __ifInstance48 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                (() => {
                                                    const __callInstance28 = new WebAssembly.Instance(__callWasmModule, {
                                                        env: {
                                                            impFunc: () => {
                                                                trace.putMetric(FIRST_CONTENTFUL_PAINT_COUNTER_NAME, Math.floor(firstContentfulPaint.startTime * 1000));
                                                            }
                                                        }
                                                    });
                                                    const __exports = __callInstance28.exports;
                                                    return __exports.data();
                                                })();
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance48.exports;
                                return __exports.data(firstContentfulPaint && firstContentfulPaint.startTime ? 1 : 0);
                            })();
                            (() => {
                                const __ifInstance49 = new WebAssembly.Instance(__ifWasmModule, {
                                    env: {
                                        impFunc1: () => {
                                            {
                                                (() => {
                                                    const __callInstance27 = new WebAssembly.Instance(__callWasmModule, {
                                                        env: {
                                                            impFunc: () => {
                                                                trace.putMetric(FIRST_INPUT_DELAY_COUNTER_NAME, Math.floor(firstInputDelay * 1000));
                                                            }
                                                        }
                                                    });
                                                    const __exports = __callInstance27.exports;
                                                    return __exports.data();
                                                })();
                                            }
                                        },
                                        impFunc2: () => {
                                        }
                                    }
                                });
                                const __exports = __ifInstance49.exports;
                                return __exports.data(firstInputDelay ? 1 : 0);
                            })();
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance46.exports;
            return __exports.data(paintTimings ? 1 : 0);
        })();
        (() => {
            const __callInstance26 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        logTrace(trace);
                    }
                }
            });
            const __exports = __callInstance26.exports;
            return __exports.data();
        })();
    }
    static createUserTimingTrace(performanceController, measureName) {
        const trace = new Trace(performanceController, measureName, false, measureName);
        (() => {
            const __callInstance25 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        logTrace(trace);
                    }
                }
            });
            const __exports = __callInstance25.exports;
            return __exports.data();
        })();
    }
}
function createNetworkRequestEntry(performanceController, entry) {
    const performanceEntry = entry;
    if (!performanceEntry || performanceEntry.responseStart === undefined) {
        return;
    }
    const timeOrigin = Api.getInstance().getTimeOrigin();
    const startTimeUs = Math.floor((performanceEntry.startTime + timeOrigin) * 1000);
    const timeToResponseInitiatedUs = performanceEntry.responseStart ? Math.floor((performanceEntry.responseStart - performanceEntry.startTime) * 1000) : undefined;
    const timeToResponseCompletedUs = Math.floor((performanceEntry.responseEnd - performanceEntry.startTime) * 1000);
    const url = performanceEntry.name && performanceEntry.name.split(lS(0, 210))[0];
    const networkRequest = {
        performanceController,
        url,
        responsePayloadBytes: performanceEntry.transferSize,
        startTimeUs,
        timeToResponseInitiatedUs,
        timeToResponseCompletedUs
    };
    (() => {
        const __callInstance24 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    logNetworkRequest(networkRequest);
                }
            }
        });
        const __exports = __callInstance24.exports;
        return __exports.data();
    })();
}
const FID_WAIT_TIME_MS = 5000;
function setupOobResources(performanceController) {
    if (!getIid()) {
        return;
    }
    (() => {
        const __callInstance23 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    setTimeout(() => setupOobTraces(performanceController), 0);
                }
            }
        });
        const __exports = __callInstance23.exports;
        return __exports.data();
    })();
    (() => {
        const __callInstance22 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    setTimeout(() => setupNetworkRequests(performanceController), 0);
                }
            }
        });
        const __exports = __callInstance22.exports;
        return __exports.data();
    })();
    (() => {
        const __callInstance21 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    setTimeout(() => setupUserTimingTraces(performanceController), 0);
                }
            }
        });
        const __exports = __callInstance21.exports;
        return __exports.data();
    })();
}
function setupNetworkRequests(performanceController) {
    const api = Api.getInstance();
    const resources = api.getEntriesByType(lS(0, 211));
    for (const resource of resources) {
        (() => {
            const __callInstance20 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        createNetworkRequestEntry(performanceController, resource);
                    }
                }
            });
            const __exports = __callInstance20.exports;
            return __exports.data();
        })();
    }
    (() => {
        const __callInstance19 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    api.setupObserver(lS(0, 212), entry => createNetworkRequestEntry(performanceController, entry));
                }
            }
        });
        const __exports = __callInstance19.exports;
        return __exports.data();
    })();
}
function setupOobTraces(performanceController) {
    const api = Api.getInstance();
    const navigationTimings = api.getEntriesByType(lS(0, 213));
    const paintTimings = api.getEntriesByType(lS(0, 214));
    (() => {
        const __ifInstance50 = new WebAssembly.Instance(__ifWasmModule, {
            env: {
                impFunc1: () => {
                    {
                        let timeoutId = setTimeout(() => {
                            (() => {
                                const __callInstance18 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            Trace.createOobTrace(performanceController, navigationTimings, paintTimings);
                                        }
                                    }
                                });
                                const __exports = __callInstance18.exports;
                                return __exports.data();
                            })();
                            timeoutId = undefined;
                        }, FID_WAIT_TIME_MS);
                        (() => {
                            const __callInstance17 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        api.onFirstInputDelay(fid => {
                                            (() => {
                                                const __ifInstance51 = new WebAssembly.Instance(__ifWasmModule, {
                                                    env: {
                                                        impFunc1: () => {
                                                            {
                                                                (() => {
                                                                    const __callInstance16 = new WebAssembly.Instance(__callWasmModule, {
                                                                        env: {
                                                                            impFunc: () => {
                                                                                clearTimeout(timeoutId);
                                                                            }
                                                                        }
                                                                    });
                                                                    const __exports = __callInstance16.exports;
                                                                    return __exports.data();
                                                                })();
                                                                (() => {
                                                                    const __callInstance15 = new WebAssembly.Instance(__callWasmModule, {
                                                                        env: {
                                                                            impFunc: () => {
                                                                                Trace.createOobTrace(performanceController, navigationTimings, paintTimings, fid);
                                                                            }
                                                                        }
                                                                    });
                                                                    const __exports = __callInstance15.exports;
                                                                    return __exports.data();
                                                                })();
                                                            }
                                                        },
                                                        impFunc2: () => {
                                                        }
                                                    }
                                                });
                                                const __exports = __ifInstance51.exports;
                                                return __exports.data(timeoutId ? 1 : 0);
                                            })();
                                        });
                                    }
                                }
                            });
                            const __exports = __callInstance17.exports;
                            return __exports.data();
                        })();
                    }
                },
                impFunc2: () => {
                    {
                        (() => {
                            const __callInstance14 = new WebAssembly.Instance(__callWasmModule, {
                                env: {
                                    impFunc: () => {
                                        Trace.createOobTrace(performanceController, navigationTimings, paintTimings);
                                    }
                                }
                            });
                            const __exports = __callInstance14.exports;
                            return __exports.data();
                        })();
                    }
                }
            }
        });
        const __exports = __ifInstance50.exports;
        return __exports.data(api.onFirstInputDelay ? 1 : 0);
    })();
}
function setupUserTimingTraces(performanceController) {
    const api = Api.getInstance();
    const measures = api.getEntriesByType(lS(0, 215));
    for (const measure of measures) {
        (() => {
            const __callInstance13 = new WebAssembly.Instance(__callWasmModule, {
                env: {
                    impFunc: () => {
                        createUserTimingTrace(performanceController, measure);
                    }
                }
            });
            const __exports = __callInstance13.exports;
            return __exports.data();
        })();
    }
    (() => {
        const __callInstance12 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    api.setupObserver(lS(0, 216), entry => createUserTimingTrace(performanceController, entry));
                }
            }
        });
        const __exports = __callInstance12.exports;
        return __exports.data();
    })();
}
function createUserTimingTrace(performanceController, measure) {
    const measureName = measure.name;
    if (measureName.substring(0, TRACE_MEASURE_PREFIX.length) === TRACE_MEASURE_PREFIX) {
        return;
    }
    (() => {
        const __callInstance11 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    Trace.createUserTimingTrace(performanceController, measureName);
                }
            }
        });
        const __exports = __callInstance11.exports;
        return __exports.data();
    })();
}
class PerformanceController {
    constructor(app, installations) {
        this.app = app;
        this.installations = installations;
        this.initialized = false;
    }
    _init(settings) {
        if (this.initialized) {
            return;
        }
        (() => {
            const __ifInstance52 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            this.dataCollectionEnabled = settings.dataCollectionEnabled;
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance52.exports;
            return __exports.data((settings === null || settings === void 0 ? void 0 : settings.dataCollectionEnabled) !== undefined ? 1 : 0);
        })();
        (() => {
            const __ifInstance53 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            this.instrumentationEnabled = settings.instrumentationEnabled;
                        }
                    },
                    impFunc2: () => {
                    }
                }
            });
            const __exports = __ifInstance53.exports;
            return __exports.data((settings === null || settings === void 0 ? void 0 : settings.instrumentationEnabled) !== undefined ? 1 : 0);
        })();
        (() => {
            const __ifInstance54 = new WebAssembly.Instance(__ifWasmModule, {
                env: {
                    impFunc1: () => {
                        {
                            (() => {
                                const __callInstance10 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            validateIndexedDBOpenable().then(isAvailable => {
                                                (() => {
                                                    const __ifInstance55 = new WebAssembly.Instance(__ifWasmModule, {
                                                        env: {
                                                            impFunc1: () => {
                                                                {
                                                                    (() => {
                                                                        const __callInstance9 = new WebAssembly.Instance(__callWasmModule, {
                                                                            env: {
                                                                                impFunc: () => {
                                                                                    setupTransportService();
                                                                                }
                                                                            }
                                                                        });
                                                                        const __exports = __callInstance9.exports;
                                                                        return __exports.data();
                                                                    })();
                                                                    (() => {
                                                                        const __callInstance8 = new WebAssembly.Instance(__callWasmModule, {
                                                                            env: {
                                                                                impFunc: () => {
                                                                                    getInitializationPromise(this).then(() => setupOobResources(this), () => setupOobResources(this));
                                                                                }
                                                                            }
                                                                        });
                                                                        const __exports = __callInstance8.exports;
                                                                        return __exports.data();
                                                                    })();
                                                                    this.initialized = true;
                                                                }
                                                            },
                                                            impFunc2: () => {
                                                            }
                                                        }
                                                    });
                                                    const __exports = __ifInstance55.exports;
                                                    return __exports.data(isAvailable ? 1 : 0);
                                                })();
                                            }).catch(error => {
                                                (() => {
                                                    const __callInstance7 = new WebAssembly.Instance(__callWasmModule, {
                                                        env: {
                                                            impFunc: () => {
                                                                consoleLogger.info(`Environment doesn't support IndexedDB: ${ error }`);
                                                            }
                                                        }
                                                    });
                                                    const __exports = __callInstance7.exports;
                                                    return __exports.data();
                                                })();
                                            });
                                        }
                                    }
                                });
                                const __exports = __callInstance10.exports;
                                return __exports.data();
                            })();
                        }
                    },
                    impFunc2: () => {
                        {
                            (() => {
                                const __callInstance6 = new WebAssembly.Instance(__callWasmModule, {
                                    env: {
                                        impFunc: () => {
                                            consoleLogger.info(lS(0, 217) + lS(0, 218));
                                        }
                                    }
                                });
                                const __exports = __callInstance6.exports;
                                return __exports.data();
                            })();
                        }
                    }
                }
            });
            const __exports = __ifInstance54.exports;
            return __exports.data(Api.getInstance().requiredApisAvailable() ? 1 : 0);
        })();
    }
    set instrumentationEnabled(val) {
        SettingsService.getInstance().instrumentationEnabled = val;
    }
    get instrumentationEnabled() {
        return SettingsService.getInstance().instrumentationEnabled;
    }
    set dataCollectionEnabled(val) {
        SettingsService.getInstance().dataCollectionEnabled = val;
    }
    get dataCollectionEnabled() {
        return SettingsService.getInstance().dataCollectionEnabled;
    }
}
const DEFAULT_ENTRY_NAME = lS(0, 219);
function getPerformance(app = getApp()) {
    app = getModularInstance(app);
    const provider = _getProvider(app, lS(0, 220));
    const perfInstance = provider.getImmediate();
    return perfInstance;
}
function initializePerformance(app, settings) {
    app = getModularInstance(app);
    const provider = _getProvider(app, lS(0, 221));
    if (provider.isInitialized()) {
        const existingInstance = provider.getImmediate();
        const initialSettings = provider.getOptions();
        if (deepEqual(initialSettings, settings !== null && settings !== void 0 ? settings : {})) {
            return existingInstance;
        } else {
            throw ERROR_FACTORY.create(lS(0, 222));
        }
    }
    const perfInstance = provider.initialize({ options: settings });
    return perfInstance;
}
function trace(performance, name) {
    performance = getModularInstance(performance);
    return new Trace(performance, name);
}
const factory = (container, {options: settings}) => {
    const app = container.getProvider(lS(0, 223)).getImmediate();
    const installations = container.getProvider(lS(0, 224)).getImmediate();
    if (app.name !== DEFAULT_ENTRY_NAME) {
        throw ERROR_FACTORY.create(lS(0, 225));
    }
    if (typeof window === lS(0, 226)) {
        throw ERROR_FACTORY.create(lS(0, 227));
    }
    (() => {
        const __callInstance5 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    setupApi(window);
                }
            }
        });
        const __exports = __callInstance5.exports;
        return __exports.data();
    })();
    const perfInstance = new PerformanceController(app, installations);
    (() => {
        const __callInstance4 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    perfInstance._init(settings);
                }
            }
        });
        const __exports = __callInstance4.exports;
        return __exports.data();
    })();
    return perfInstance;
};
function registerPerformance() {
    (() => {
        const __callInstance3 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    _registerComponent(new Component(lS(0, 228), factory, lS(0, 229)));
                }
            }
        });
        const __exports = __callInstance3.exports;
        return __exports.data();
    })();
    (() => {
        const __callInstance2 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    registerVersion(name, version);
                }
            }
        });
        const __exports = __callInstance2.exports;
        return __exports.data();
    })();
    (() => {
        const __callInstance1 = new WebAssembly.Instance(__callWasmModule, {
            env: {
                impFunc: () => {
                    registerVersion(name, version, lS(0, 230));
                }
            }
        });
        const __exports = __callInstance1.exports;
        return __exports.data();
    })();
}
(() => {
    const __callInstance0 = new WebAssembly.Instance(__callWasmModule, {
        env: {
            impFunc: () => {
                registerPerformance();
            }
        }
    });
    const __exports = __callInstance0.exports;
    return __exports.data();
})();
export {
    getPerformance,
    initializePerformance,
    trace
};</script>
</body>
</html>
